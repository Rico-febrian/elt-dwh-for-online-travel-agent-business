2024-11-08 18:12:36,974 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-08 18:12:37,033 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-08 18:12:37,048 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-08 18:12:37,054 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-08 18:12:37,065 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-08 18:12:37,084 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-08 18:12:37,192 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-08 18:12:37,199 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-08 18:12:37,199 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-08 18:12:37,200 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-08 18:12:37,200 - INFO - [pid 1408] Worker Worker(salt=4126562209, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1408) done      Extract()
2024-11-08 18:12:37,201 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:12:37,204 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-08 18:12:37,204 - DEBUG - Asking scheduler for work...
2024-11-08 18:12:37,206 - DEBUG - Pending tasks: 1
2024-11-08 18:12:37,207 - INFO - [pid 1408] Worker Worker(salt=4126562209, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1408) running   Load()
2024-11-08 18:12:37,210 - INFO - Read Load Query - SUCCESS!
2024-11-08 18:12:37,239 - INFO - Read Extracted Data - SUCCESS!
2024-11-08 18:12:37,240 - INFO - Connect to DWH - SUCCESS!
2024-11-08 18:12:37,344 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-08 18:12:37,344 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-08 18:12:38,245 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-08 18:12:38,252 - ERROR - LOAD All Tables To Pactravel Staging - FAILED
2024-11-08 18:12:38,254 - ERROR - LOAD All Tables To Pactravel DWH - FAILED
2024-11-08 18:12:38,254 - ERROR - [pid 1408] Worker Worker(salt=4126562209, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1408) failed    Load()
Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1970, in _exec_single_context
    self.dialect.do_execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "aircraft_name" of relation "airlines" does not exist
LINE 6:     (airline_id, aircraft_name, country, airline_iata, airli...
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 224, in run
    session.execute(query)
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2306, in execute
    return self._execute_internal(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2200, in _execute_internal
    result = conn.execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1421, in execute
    return meth(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1643, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1849, in _execute_context
    return self._exec_single_context(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1989, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2356, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1970, in _exec_single_context
    self.dialect.do_execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "aircraft_name" of relation "airlines" does not exist
LINE 6:     (airline_id, aircraft_name, country, airline_iata, airli...
                         ^

[SQL: --
--- Query for load data and handling new data (upsert) from db sources into staging schema in DWH
--

INSERT INTO pactravel_staging.airlines
    (airline_id, aircraft_name, country, airline_iata, airline_icao)

SELECT
    airline_id,
    airline_name,
    country,
    airline_iata,
    airline_icao

FROM public.airlines

-- Handle new data
ON CONFLICT(airline_id) 
DO UPDATE SET
    airline_name = EXCLUDED.airline_name,
    country = EXCLUDED.country,
    airline_iata = EXCLUDED.airline_iata,
    airline_icao = EXCLUDED.airline_icao,

    -- Handle updated timestamp
    updated_at = CASE WHEN 
                        pactravel_staging.airlines.airline_name <> EXCLUDED.airline_name 
                        OR pactravel_staging.airlines.country <> EXCLUDED.country
                        OR pactravel_staging.airlines.airline_iata <> EXCLUDED.airline_iata
                        OR pactravel_staging.airlines.airline_icao <> EXCLUDED.airline_icao
                THEN
                        CURRENT_TIMESTAMP
                ELSE
                        pactravel_staging.airlines.updated_at
                END;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 235, in run
    raise Exception('Failed Load Tables To Pactravel Staging')
Exception: Failed Load Tables To Pactravel Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 274, in run
    raise Exception('Failed Load Tables To Pactravel DWH')
Exception: Failed Load Tables To Pactravel DWH
2024-11-08 18:12:38,263 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:12:38,268 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2024-11-08 18:12:38,268 - DEBUG - Asking scheduler for work...
2024-11-08 18:12:38,271 - DEBUG - Done
2024-11-08 18:12:38,271 - DEBUG - There are no more tasks to run at this time
2024-11-08 18:12:38,271 - DEBUG - There are 1 pending tasks possibly being run by other workers
2024-11-08 18:12:38,271 - DEBUG - There are 1 pending tasks last scheduled by this worker
2024-11-08 18:12:38,272 - INFO - Worker Worker(salt=4126562209, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1408) was stopped. Shutting down Keep-Alive thread
2024-11-08 18:12:38,273 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 ran successfully:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2024-11-08 18:13:42,682 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-08 18:13:42,706 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-08 18:13:42,714 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-08 18:13:42,718 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-08 18:13:42,725 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-08 18:13:42,737 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-08 18:13:42,812 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-08 18:13:42,818 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-08 18:13:42,818 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-08 18:13:42,819 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-08 18:13:42,820 - INFO - [pid 1945] Worker Worker(salt=916217630, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1945) done      Extract()
2024-11-08 18:13:42,821 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:13:42,824 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-08 18:13:42,824 - DEBUG - Asking scheduler for work...
2024-11-08 18:13:42,825 - DEBUG - Pending tasks: 1
2024-11-08 18:13:42,826 - INFO - [pid 1945] Worker Worker(salt=916217630, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1945) running   Load()
2024-11-08 18:13:42,826 - INFO - Read Load Query - SUCCESS!
2024-11-08 18:13:42,851 - INFO - Read Extracted Data - SUCCESS!
2024-11-08 18:13:42,852 - INFO - Connect to DWH - SUCCESS!
2024-11-08 18:13:42,984 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-08 18:13:42,984 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-08 18:13:43,746 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-08 18:13:43,780 - ERROR - LOAD All Tables To Pactravel Staging - FAILED
2024-11-08 18:13:43,782 - ERROR - LOAD All Tables To Pactravel DWH - FAILED
2024-11-08 18:13:43,782 - ERROR - [pid 1945] Worker Worker(salt=916217630, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1945) failed    Load()
Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1970, in _exec_single_context
    self.dialect.do_execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.SyntaxError: INSERT has more expressions than target columns
LINE 23:     (departure_date - floor(random() * 30)::int) as flight_b...
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 224, in run
    session.execute(query)
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2306, in execute
    return self._execute_internal(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2200, in _execute_internal
    result = conn.execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1421, in execute
    return meth(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1643, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1849, in _execute_context
    return self._exec_single_context(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1989, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2356, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1970, in _exec_single_context
    self.dialect.do_execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) INSERT has more expressions than target columns
LINE 23:     (departure_date - floor(random() * 30)::int) as flight_b...
              ^

[SQL: --
--- Query for load data and handling new data (upsert) from db sources into staging schema in DWH
--

INSERT INTO pactravel_staging.flight_bookings
    (trip_id, customer_id, flight_number, airline_id, aircraft_id, airport_src, airport_dst, departure_time, departure_date,
     flight_duration, travel_class, seat_number, price)

SELECT
    trip_id,
    customer_id,
    flight_number,
    airline_id,
    aircraft_id,
    airport_src,
    airport_dst,
    departure_time,
    departure_date,
    flight_duration, 
    travel_class,
    seat_number,
    price,
    (departure_date - floor(random() * 30)::int) as flight_booking_date


FROM public.flight_bookings

-- Handle new data
ON CONFLICT(trip_id, flight_number, seat_number)
DO UPDATE SET
    customer_id = EXCLUDED.customer_id,
    airline_id = EXCLUDED.airline_id,
    aircraft_id = EXCLUDED.aircraft_id,
    airport_src = EXCLUDED.airport_src,
    airport_dst = EXCLUDED.airport_dst,
    departure_time = EXCLUDED.departure_time,
    departure_date = EXCLUDED.departure_date,
    flight_duration = EXCLUDED.flight_duration, 
    travel_class = EXCLUDED.travel_class,
    price = EXCLUDED.price,
    flight_booking_date = EXCLUDED.flight_booking_date,

    -- Handle updated timestamp
    updated_at = CASE WHEN 
                        pactravel_staging.flight_bookings.customer_id <> EXCLUDED.customer_id
                        OR pactravel_staging.flight_bookings.airline_id <> EXCLUDED.airline_id
                        OR pactravel_staging.flight_bookings.aircraft_id <> EXCLUDED.aircraft_id
                        OR pactravel_staging.flight_bookings.airport_src <> EXCLUDED.airport_src
                        OR pactravel_staging.flight_bookings.airport_dst <> EXCLUDED.airport_dst
                        OR pactravel_staging.flight_bookings.departure_time <> EXCLUDED.departure_time
                        OR pactravel_staging.flight_bookings.departure_date <> EXCLUDED.departure_date
                        OR pactravel_staging.flight_bookings.flight_duration <> EXCLUDED.flight_duration
                        OR pactravel_staging.flight_bookings.travel_class <> EXCLUDED.travel_class
                        OR pactravel_staging.flight_bookings.price <> EXCLUDED.price
                        OR pactravel_staging.flight_bookings.flight_booking_date <> EXCLUDED.flight_booking_date
                THEN
                        CURRENT_TIMESTAMP
                ELSE
                        pactravel_staging.flight_bookings.updated_at
                END;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 235, in run
    raise Exception('Failed Load Tables To Pactravel Staging')
Exception: Failed Load Tables To Pactravel Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 274, in run
    raise Exception('Failed Load Tables To Pactravel DWH')
Exception: Failed Load Tables To Pactravel DWH
2024-11-08 18:13:43,785 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:13:43,790 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2024-11-08 18:13:43,790 - DEBUG - Asking scheduler for work...
2024-11-08 18:13:43,792 - DEBUG - Done
2024-11-08 18:13:43,792 - DEBUG - There are no more tasks to run at this time
2024-11-08 18:13:43,793 - DEBUG - There are 1 pending tasks possibly being run by other workers
2024-11-08 18:13:43,793 - DEBUG - There are 1 pending tasks unique to this worker
2024-11-08 18:13:43,793 - DEBUG - There are 1 pending tasks last scheduled by this worker
2024-11-08 18:13:43,793 - INFO - Worker Worker(salt=916217630, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=1945) was stopped. Shutting down Keep-Alive thread
2024-11-08 18:13:43,794 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 ran successfully:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2024-11-08 18:15:17,786 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-08 18:15:17,820 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-08 18:15:17,829 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-08 18:15:17,833 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-08 18:15:17,840 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-08 18:15:17,852 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-08 18:15:17,918 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-08 18:15:17,924 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-08 18:15:17,925 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-08 18:15:17,926 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-08 18:15:17,926 - INFO - [pid 2677] Worker Worker(salt=5154908974, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=2677) done      Extract()
2024-11-08 18:15:17,926 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:15:17,929 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-08 18:15:17,929 - DEBUG - Asking scheduler for work...
2024-11-08 18:15:17,931 - DEBUG - Pending tasks: 1
2024-11-08 18:15:17,931 - INFO - [pid 2677] Worker Worker(salt=5154908974, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=2677) running   Load()
2024-11-08 18:15:17,932 - INFO - Read Load Query - SUCCESS!
2024-11-08 18:15:17,959 - INFO - Read Extracted Data - SUCCESS!
2024-11-08 18:15:17,960 - INFO - Connect to DWH - SUCCESS!
2024-11-08 18:15:18,066 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-08 18:15:18,066 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-08 18:15:18,832 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-08 18:15:18,860 - ERROR - LOAD All Tables To Pactravel Staging - FAILED
2024-11-08 18:15:18,861 - ERROR - LOAD All Tables To Pactravel DWH - FAILED
2024-11-08 18:15:18,861 - ERROR - [pid 2677] Worker Worker(salt=5154908974, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=2677) failed    Load()
Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1970, in _exec_single_context
    self.dialect.do_execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.SyntaxError: INSERT has more expressions than target columns
LINE 23:     ((departure_date - floor(random() * 30)::int)) as flight...
               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 224, in run
    session.execute(query)
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2306, in execute
    return self._execute_internal(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2200, in _execute_internal
    result = conn.execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1421, in execute
    return meth(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 514, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1643, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1849, in _execute_context
    return self._exec_single_context(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1989, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2356, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1970, in _exec_single_context
    self.dialect.do_execute(
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) INSERT has more expressions than target columns
LINE 23:     ((departure_date - floor(random() * 30)::int)) as flight...
               ^

[SQL: --
--- Query for load data and handling new data (upsert) from db sources into staging schema in DWH
--

INSERT INTO pactravel_staging.flight_bookings
    (trip_id, customer_id, flight_number, airline_id, aircraft_id, airport_src, airport_dst, departure_time, departure_date,
     flight_duration, travel_class, seat_number, price)

SELECT
    trip_id,
    customer_id,
    flight_number,
    airline_id,
    aircraft_id,
    airport_src,
    airport_dst,
    departure_time,
    departure_date,
    flight_duration, 
    travel_class,
    seat_number,
    price,
    ((departure_date - floor(random() * 30)::int)) as flight_booking_date


FROM public.flight_bookings

-- Handle new data
ON CONFLICT(trip_id, flight_number, seat_number)
DO UPDATE SET
    customer_id = EXCLUDED.customer_id,
    airline_id = EXCLUDED.airline_id,
    aircraft_id = EXCLUDED.aircraft_id,
    airport_src = EXCLUDED.airport_src,
    airport_dst = EXCLUDED.airport_dst,
    departure_time = EXCLUDED.departure_time,
    departure_date = EXCLUDED.departure_date,
    flight_duration = EXCLUDED.flight_duration, 
    travel_class = EXCLUDED.travel_class,
    price = EXCLUDED.price,
    flight_booking_date = EXCLUDED.flight_booking_date,

    -- Handle updated timestamp
    updated_at = CASE WHEN 
                        pactravel_staging.flight_bookings.customer_id <> EXCLUDED.customer_id
                        OR pactravel_staging.flight_bookings.airline_id <> EXCLUDED.airline_id
                        OR pactravel_staging.flight_bookings.aircraft_id <> EXCLUDED.aircraft_id
                        OR pactravel_staging.flight_bookings.airport_src <> EXCLUDED.airport_src
                        OR pactravel_staging.flight_bookings.airport_dst <> EXCLUDED.airport_dst
                        OR pactravel_staging.flight_bookings.departure_time <> EXCLUDED.departure_time
                        OR pactravel_staging.flight_bookings.departure_date <> EXCLUDED.departure_date
                        OR pactravel_staging.flight_bookings.flight_duration <> EXCLUDED.flight_duration
                        OR pactravel_staging.flight_bookings.travel_class <> EXCLUDED.travel_class
                        OR pactravel_staging.flight_bookings.price <> EXCLUDED.price
                        OR pactravel_staging.flight_bookings.flight_booking_date <> EXCLUDED.flight_booking_date
                THEN
                        CURRENT_TIMESTAMP
                ELSE
                        pactravel_staging.flight_bookings.updated_at
                END;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 235, in run
    raise Exception('Failed Load Tables To Pactravel Staging')
Exception: Failed Load Tables To Pactravel Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/elt-pactravel/lib/python3.10/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/ricofebrian/data-warehouse-labs/exercise/exercise-3/pipeline/load.py", line 274, in run
    raise Exception('Failed Load Tables To Pactravel DWH')
Exception: Failed Load Tables To Pactravel DWH
2024-11-08 18:15:18,863 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:15:18,868 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2024-11-08 18:15:18,868 - DEBUG - Asking scheduler for work...
2024-11-08 18:15:18,870 - DEBUG - Done
2024-11-08 18:15:18,870 - DEBUG - There are no more tasks to run at this time
2024-11-08 18:15:18,870 - DEBUG - There are 1 pending tasks possibly being run by other workers
2024-11-08 18:15:18,871 - DEBUG - There are 1 pending tasks last scheduled by this worker
2024-11-08 18:15:18,871 - INFO - Worker Worker(salt=5154908974, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=2677) was stopped. Shutting down Keep-Alive thread
2024-11-08 18:15:18,872 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 ran successfully:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2024-11-08 18:16:59,232 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-08 18:16:59,262 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-08 18:16:59,272 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-08 18:16:59,277 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-08 18:16:59,287 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-08 18:16:59,304 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-08 18:16:59,415 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-08 18:16:59,424 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-08 18:16:59,424 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-08 18:16:59,426 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-08 18:16:59,426 - INFO - [pid 3460] Worker Worker(salt=2105532039, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=3460) done      Extract()
2024-11-08 18:16:59,426 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:16:59,430 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-08 18:16:59,430 - DEBUG - Asking scheduler for work...
2024-11-08 18:16:59,432 - DEBUG - Pending tasks: 1
2024-11-08 18:16:59,432 - INFO - [pid 3460] Worker Worker(salt=2105532039, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=3460) running   Load()
2024-11-08 18:16:59,433 - INFO - Read Load Query - SUCCESS!
2024-11-08 18:16:59,463 - INFO - Read Extracted Data - SUCCESS!
2024-11-08 18:16:59,464 - INFO - Connect to DWH - SUCCESS!
2024-11-08 18:16:59,589 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-08 18:16:59,589 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-08 18:17:00,460 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-08 18:17:00,977 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-08 18:17:00,978 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-08 18:17:00,979 - INFO - [pid 3460] Worker Worker(salt=2105532039, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=3460) done      Load()
2024-11-08 18:17:00,979 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 18:17:00,982 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-08 18:17:00,983 - DEBUG - Asking scheduler for work...
2024-11-08 18:17:00,984 - DEBUG - Done
2024-11-08 18:17:00,984 - DEBUG - There are no more tasks to run at this time
2024-11-08 18:17:00,985 - INFO - Worker Worker(salt=2105532039, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=3460) was stopped. Shutting down Keep-Alive thread
2024-11-08 18:17:00,985 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 ran successfully:
    - 1 Extract()
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2024-11-08 20:27:05,061 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-08 20:27:05,288 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-08 20:27:05,337 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-08 20:27:05,356 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-08 20:27:05,420 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-08 20:27:05,508 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-08 20:27:05,832 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-08 20:27:05,845 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-08 20:27:05,845 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-08 20:27:05,854 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-08 20:27:05,854 - INFO - [pid 58368] Worker Worker(salt=8580371524, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=58368) done      Extract()
2024-11-08 20:27:05,860 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 20:27:05,872 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-08 20:27:05,873 - DEBUG - Asking scheduler for work...
2024-11-08 20:27:05,884 - DEBUG - Pending tasks: 2
2024-11-08 20:27:05,884 - INFO - [pid 58368] Worker Worker(salt=8580371524, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=58368) running   Load()
2024-11-08 20:27:05,889 - INFO - Read Load Query - SUCCESS!
2024-11-08 20:27:06,015 - INFO - Read Extracted Data - SUCCESS!
2024-11-08 20:27:06,018 - INFO - Connect to DWH - SUCCESS!
2024-11-08 20:27:06,450 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-08 20:27:06,451 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-08 20:27:09,737 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-08 20:27:10,491 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-08 20:27:10,495 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-08 20:27:10,496 - INFO - [pid 58368] Worker Worker(salt=8580371524, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=58368) done      Load()
2024-11-08 20:27:10,497 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 20:27:10,505 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-08 20:27:10,505 - DEBUG - Asking scheduler for work...
2024-11-08 20:27:10,511 - DEBUG - Pending tasks: 1
2024-11-08 20:27:10,511 - INFO - [pid 58368] Worker Worker(salt=8580371524, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=58368) running   Transform()
2024-11-08 20:27:10,512 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m13:27:16  Running with dbt=1.9.0-b2
[0m13:27:19  Installing dbt-labs/dbt_utils
[0m13:27:20  Installed from version 1.1.1
[0m13:27:20  Updated version available: 1.3.0
[0m13:27:20  Installing calogica/dbt_date
[0m13:27:21  Installed from version 0.10.0
[0m13:27:21  Updated version available: 0.10.1
[0m13:27:21  Installing Snowflake-Labs/dbt_constraints
[0m13:27:34  Installed from version 0.6.3
[0m13:27:34  Updated version available: 1.0.4
[0m13:27:34  
[0m13:27:34  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m13:27:39  Running with dbt=1.9.0-b2
[0m13:27:40  Registered adapter: postgres=1.8.2
[0m13:27:40  Unable to do partial parsing because of a version mismatch
[0m13:27:46  [[33mWARNING[0m]: 'dim_date' is a seed node, but it is specified in the models section of
models/marts/core/_core__models.yml. To fix this error, place the `dim_date`
specification under the seeds key instead.
[0m13:27:48  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m13:27:48  
[0m13:27:48  Concurrency: 1 threads (target='dev')
[0m13:27:48  
[0m13:27:49  1 of 1 START seed file pactravel_final.dim_date ................................ [RUN]
[0m13:32:53  1 of 1 OK loaded seed file pactravel_final.dim_date ............................ [[32mINSERT 29220[0m in 303.90s]
[0m13:32:53  
[0m13:32:53  Running dbt Constraints
[0m13:32:53  Finished dbt Constraints
[0m13:32:53  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m13:32:53  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.16s]
[0m13:32:53  
[0m13:32:53  Finished running 1 project hook, 1 seed in 0 hours 5 minutes and 4.88 seconds (304.88s).
[0m13:32:53  
[0m13:32:53  [32mCompleted successfully[0m
[0m13:32:53  
[0m13:32:53  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:32:59  Running with dbt=1.9.0-b2
[0m13:32:59  Registered adapter: postgres=1.8.2
[0m13:33:01  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m13:33:01  
[0m13:33:01  Concurrency: 1 threads (target='dev')
[0m13:33:01  
[0m13:33:01  1 of 15 START sql view model pactravel_final.stg_pactravel__aircrafts .......... [RUN]
[0m13:33:02  1 of 15 OK created sql view model pactravel_final.stg_pactravel__aircrafts ..... [[32mCREATE VIEW[0m in 0.40s]
[0m13:33:02  2 of 15 START sql view model pactravel_final.stg_pactravel__airlines ........... [RUN]
[0m13:33:02  2 of 15 OK created sql view model pactravel_final.stg_pactravel__airlines ...... [[32mCREATE VIEW[0m in 0.19s]
[0m13:33:02  3 of 15 START sql view model pactravel_final.stg_pactravel__airports ........... [RUN]
[0m13:33:02  3 of 15 OK created sql view model pactravel_final.stg_pactravel__airports ...... [[32mCREATE VIEW[0m in 0.22s]
[0m13:33:02  4 of 15 START sql view model pactravel_final.stg_pactravel__customers .......... [RUN]
[0m13:33:02  4 of 15 OK created sql view model pactravel_final.stg_pactravel__customers ..... [[32mCREATE VIEW[0m in 0.26s]
[0m13:33:02  5 of 15 START sql view model pactravel_final.stg_pactravel__flight_bookings .... [RUN]
[0m13:33:03  5 of 15 OK created sql view model pactravel_final.stg_pactravel__flight_bookings  [[32mCREATE VIEW[0m in 0.25s]
[0m13:33:03  6 of 15 START sql view model pactravel_final.stg_pactravel__hotel .............. [RUN]
[0m13:33:03  6 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel ......... [[32mCREATE VIEW[0m in 0.28s]
[0m13:33:03  7 of 15 START sql view model pactravel_final.stg_pactravel__hotel_bookings ..... [RUN]
[0m13:33:03  7 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel_bookings  [[32mCREATE VIEW[0m in 0.36s]
[0m13:33:03  8 of 15 START sql table model pactravel_final.dim_aircrafts .................... [RUN]
[0m13:33:04  8 of 15 OK created sql table model pactravel_final.dim_aircrafts ............... [[32mSELECT 246[0m in 0.47s]
[0m13:33:04  9 of 15 START sql table model pactravel_final.dim_airlines ..................... [RUN]
[0m13:33:04  9 of 15 OK created sql table model pactravel_final.dim_airlines ................ [[32mSELECT 1251[0m in 0.55s]
[0m13:33:04  10 of 15 START sql table model pactravel_final.dim_airports .................... [RUN]
[0m13:33:05  10 of 15 OK created sql table model pactravel_final.dim_airports ............... [[32mSELECT 105[0m in 0.39s]
[0m13:33:05  11 of 15 START sql table model pactravel_final.dim_customers ................... [RUN]
[0m13:33:05  11 of 15 OK created sql table model pactravel_final.dim_customers .............. [[32mSELECT 1000[0m in 0.42s]
[0m13:33:05  12 of 15 START sql table model pactravel_final.dim_hotel ....................... [RUN]
[0m13:33:06  12 of 15 OK created sql table model pactravel_final.dim_hotel .................. [[32mSELECT 1470[0m in 0.45s]
[0m13:33:06  13 of 15 START sql table model pactravel_final.fct_daily_revenue ............... [RUN]
[0m13:33:06  13 of 15 OK created sql table model pactravel_final.fct_daily_revenue .......... [[32mSELECT 2407[0m in 0.52s]
[0m13:33:06  14 of 15 START sql table model pactravel_final.fct_flight_bookings ............. [RUN]
[0m13:33:11  14 of 15 OK created sql table model pactravel_final.fct_flight_bookings ........ [[32mSELECT 8190[0m in 4.40s]
[0m13:33:11  15 of 15 START sql table model pactravel_final.fct_hotel_bookings .............. [RUN]
[0m13:33:12  15 of 15 OK created sql table model pactravel_final.fct_hotel_bookings ......... [[32mSELECT 217[0m in 1.73s]
[0m13:33:12  
[0m13:33:12  Running dbt Constraints
[0m13:33:13  Finished dbt Constraints
[0m13:33:13  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m13:33:13  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.22s]
[0m13:33:13  
[0m13:33:13  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 11.84 seconds (11.84s).
[0m13:33:13  
[0m13:33:13  [32mCompleted successfully[0m
[0m13:33:13  
[0m13:33:13  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m13:33:18  Running with dbt=1.9.0-b2
[0m13:33:19  Registered adapter: postgres=1.8.2
[0m13:33:21  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m13:33:21  
[0m13:33:21  Concurrency: 1 threads (target='dev')
[0m13:33:21  
[0m13:33:21  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m13:33:22  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mINSERT 0 1251[0m in 1.10s]
[0m13:33:22  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m13:33:23  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mINSERT 0 1000[0m in 0.45s]
[0m13:33:23  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m13:33:23  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mINSERT 0 1470[0m in 0.45s]
[0m13:33:23  
[0m13:33:23  Running dbt Constraints
[0m13:33:23  Finished dbt Constraints
[0m13:33:23  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m13:33:23  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.23s]
[0m13:33:23  
[0m13:33:23  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m13:33:24  
[0m13:33:24  [32mCompleted successfully[0m
[0m13:33:24  
[0m13:33:24  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:33:30  Running with dbt=1.9.0-b2
[0m13:33:30  Registered adapter: postgres=1.8.2
[0m13:33:31  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m13:33:31  
[0m13:33:31  Concurrency: 1 threads (target='dev')
[0m13:33:31  
[0m13:33:32  1 of 47 START test dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [RUN]
[0m13:33:32  1 of 47 PASS dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.18s]
[0m13:33:32  2 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m13:33:32  2 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.09s]
[0m13:33:32  3 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m13:33:32  3 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.09s]
[0m13:33:32  4 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m13:33:32  4 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.09s]
[0m13:33:32  5 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m13:33:32  5 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.10s]
[0m13:33:32  6 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m13:33:32  6 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.17s]
[0m13:33:32  7 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m13:33:33  7 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.16s]
[0m13:33:33  8 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m13:33:33  8 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.14s]
[0m13:33:33  9 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m13:33:33  9 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.15s]
[0m13:33:33  10 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m13:33:33  10 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.16s]
[0m13:33:33  11 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m13:33:33  11 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.15s]
[0m13:33:33  12 of 47 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m13:33:33  12 of 47 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.20s]
[0m13:33:33  13 of 47 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m13:33:33  13 of 47 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.06s]
[0m13:33:33  14 of 47 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m13:33:34  14 of 47 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.07s]
[0m13:33:34  15 of 47 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m13:33:34  15 of 47 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.12s]
[0m13:33:34  16 of 47 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m13:33:34  16 of 47 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.19s]
[0m13:33:34  17 of 47 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m13:33:34  17 of 47 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.14s]
[0m13:33:34  18 of 47 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m13:33:34  18 of 47 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.16s]
[0m13:33:34  19 of 47 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m13:33:34  19 of 47 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.13s]
[0m13:33:34  20 of 47 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m13:33:35  20 of 47 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.16s]
[0m13:33:35  21 of 47 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m13:33:35  21 of 47 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.13s]
[0m13:33:35  22 of 47 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m13:33:35  22 of 47 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.13s]
[0m13:33:35  23 of 47 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m13:33:35  23 of 47 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.13s]
[0m13:33:35  24 of 47 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m13:33:35  24 of 47 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.13s]
[0m13:33:35  25 of 47 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m13:33:35  25 of 47 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.13s]
[0m13:33:35  26 of 47 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m13:33:35  26 of 47 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.15s]
[0m13:33:35  27 of 47 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m13:33:36  27 of 47 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.17s]
[0m13:33:36  28 of 47 START test not_null_dim_date_date_id .................................. [RUN]
[0m13:33:36  28 of 47 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.15s]
[0m13:33:36  29 of 47 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m13:33:36  29 of 47 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.13s]
[0m13:33:36  30 of 47 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m13:33:36  30 of 47 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.16s]
[0m13:33:36  31 of 47 START test not_null_fct_daily_revenue_booking_date .................... [RUN]
[0m13:33:36  31 of 47 PASS not_null_fct_daily_revenue_booking_date .......................... [[32mPASS[0m in 0.17s]
[0m13:33:36  32 of 47 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m13:33:36  32 of 47 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.15s]
[0m13:33:36  33 of 47 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m13:33:37  33 of 47 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.18s]
[0m13:33:37  34 of 47 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m13:33:37  34 of 47 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.15s]
[0m13:33:37  35 of 47 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m13:33:37  35 of 47 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.31s]
[0m13:33:37  36 of 47 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m13:33:37  36 of 47 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.13s]
[0m13:33:37  37 of 47 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m13:33:37  37 of 47 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.14s]
[0m13:33:37  38 of 47 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m13:33:38  38 of 47 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.14s]
[0m13:33:38  39 of 47 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m13:33:38  39 of 47 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.13s]
[0m13:33:38  40 of 47 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m13:33:38  40 of 47 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.13s]
[0m13:33:38  41 of 47 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m13:33:38  41 of 47 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.12s]
[0m13:33:38  42 of 47 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m13:33:38  42 of 47 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.13s]
[0m13:33:38  43 of 47 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m13:33:38  43 of 47 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.13s]
[0m13:33:38  44 of 47 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m13:33:38  44 of 47 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.15s]
[0m13:33:38  45 of 47 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m13:33:39  45 of 47 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.15s]
[0m13:33:39  46 of 47 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m13:33:39  46 of 47 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.13s]
[0m13:33:39  47 of 47 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m13:33:39  47 of 47 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.13s]
[0m13:33:39  
[0m13:33:39  Running dbt Constraints
[0m13:33:39  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m13:33:39  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m13:33:39  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m13:33:39  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m13:33:40  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m13:33:40  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m13:33:40  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m13:33:40  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m13:33:40  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m13:33:40  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m13:33:40  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m13:33:40  Creating not null constraint for: booking_date in "pactravel-dwh"."pactravel_final"."fct_daily_revenue"
[0m13:33:40  Creating not null constraint for: aircraft_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: airline_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: arrival_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: departure_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: departure_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:40  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:41  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:41  Creating not null constraint for: check_in_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: check_out_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: hotel_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:41  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m13:33:41  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m13:33:41  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m13:33:41  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m13:33:41  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m13:33:41  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m13:33:41  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m13:33:42  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m13:33:42  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m13:33:42  Creating primary key: DIM_DATE_DATE_ID_PK
[0m13:33:42  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m13:33:42  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m13:33:42  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m13:33:42  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m13:33:42  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m13:33:42  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m13:33:42  Skipping FCT_DAILY_REVENUE_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m13:33:43  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_aircrafts" ['nk_aircraft_id']
[0m13:33:43  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airlines" ['nk_airline_id']
[0m13:33:43  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m13:33:43  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m13:33:43  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m13:33:43  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m13:33:43  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m13:33:43  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m13:33:43  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m13:33:43  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_hotel" ['nk_hotel_id']
[0m13:33:43  Finished dbt Constraints
[0m13:33:43  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m13:33:43  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 4.12s]
[0m13:33:43  
[0m13:33:43  Finished running 1 project hook, 47 data tests in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m13:33:43  
[0m13:33:43  [32mCompleted successfully[0m
[0m13:33:43  
[0m13:33:43  Done. PASS=48 WARN=0 ERROR=0 SKIP=0 TOTAL=48
2024-11-08 20:33:46,788 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2024-11-08 20:33:46,789 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2024-11-08 20:33:46,791 - INFO - [pid 58368] Worker Worker(salt=8580371524, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=58368) done      Transform()
2024-11-08 20:33:46,798 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 20:33:46,817 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2024-11-08 20:33:46,818 - DEBUG - Asking scheduler for work...
2024-11-08 20:33:46,828 - DEBUG - Done
2024-11-08 20:33:46,828 - DEBUG - There are no more tasks to run at this time
2024-11-08 20:33:46,833 - INFO - Worker Worker(salt=8580371524, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=58368) was stopped. Shutting down Keep-Alive thread
2024-11-08 20:33:46,852 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2024-11-08 21:01:12,526 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-08 21:01:12,639 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-08 21:01:12,654 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-08 21:01:12,660 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-08 21:01:12,676 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-08 21:01:12,703 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-08 21:01:12,806 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-08 21:01:12,815 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-08 21:01:12,815 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-08 21:01:12,820 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-08 21:01:12,820 - INFO - [pid 74098] Worker Worker(salt=8389341441, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=74098) done      Extract()
2024-11-08 21:01:12,822 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 21:01:12,826 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-08 21:01:12,826 - DEBUG - Asking scheduler for work...
2024-11-08 21:01:12,828 - DEBUG - Pending tasks: 2
2024-11-08 21:01:12,829 - INFO - [pid 74098] Worker Worker(salt=8389341441, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=74098) running   Load()
2024-11-08 21:01:12,831 - INFO - Read Load Query - SUCCESS!
2024-11-08 21:01:12,864 - INFO - Read Extracted Data - SUCCESS!
2024-11-08 21:01:12,864 - INFO - Connect to DWH - SUCCESS!
2024-11-08 21:01:13,029 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-08 21:01:13,029 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-08 21:01:14,026 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-08 21:01:14,445 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-08 21:01:14,448 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-08 21:01:14,448 - INFO - [pid 74098] Worker Worker(salt=8389341441, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=74098) done      Load()
2024-11-08 21:01:14,449 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 21:01:14,451 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-08 21:01:14,452 - DEBUG - Asking scheduler for work...
2024-11-08 21:01:14,454 - DEBUG - Pending tasks: 1
2024-11-08 21:01:14,454 - INFO - [pid 74098] Worker Worker(salt=8389341441, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=74098) running   Transform()
2024-11-08 21:01:14,455 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m14:01:16  Running with dbt=1.9.0-b4
[0m14:01:18  Installing dbt-labs/dbt_utils
[0m14:01:19  Installed from version 1.1.1
[0m14:01:19  Updated version available: 1.3.0
[0m14:01:19  Installing calogica/dbt_date
[0m14:01:20  Installed from version 0.10.0
[0m14:01:20  Updated version available: 0.10.1
[0m14:01:20  Installing Snowflake-Labs/dbt_constraints
[0m14:01:24  Installed from version 0.6.3
[0m14:01:24  Updated version available: 1.0.4
[0m14:01:24  
[0m14:01:24  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m14:01:27  Running with dbt=1.9.0-b4
[0m14:01:27  Registered adapter: postgres=1.8.2
[0m14:01:28  Unable to do partial parsing because of a version mismatch
[0m14:01:30  [[33mWARNING[0m]: 'dim_date' is a seed node, but it is specified in the models section of
models/marts/core/_core__models.yml. To fix this error, place the `dim_date`
specification under the seeds key instead.
[0m14:01:31  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m14:01:31  
[0m14:01:31  Concurrency: 1 threads (target='dev')
[0m14:01:31  
[0m14:01:31  1 of 1 START seed file pactravel_final.dim_date ................................ [RUN]
[0m14:03:47  1 of 1 OK loaded seed file pactravel_final.dim_date ............................ [[32mINSERT 29220[0m in 135.25s]
[0m14:03:47  
[0m14:03:47  Running dbt Constraints
[0m14:03:47  Finished dbt Constraints
[0m14:03:47  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m14:03:47  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m14:03:47  
[0m14:03:47  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 15.69 seconds (135.69s).
[0m14:03:47  
[0m14:03:47  [32mCompleted successfully[0m
[0m14:03:47  
[0m14:03:47  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:03:50  Running with dbt=1.9.0-b4
[0m14:03:50  Registered adapter: postgres=1.8.2
[0m14:03:50  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m14:03:50  
[0m14:03:50  Concurrency: 1 threads (target='dev')
[0m14:03:50  
[0m14:03:51  1 of 15 START sql view model pactravel_final.stg_pactravel__aircrafts .......... [RUN]
[0m14:03:51  1 of 15 OK created sql view model pactravel_final.stg_pactravel__aircrafts ..... [[32mCREATE VIEW[0m in 0.12s]
[0m14:03:51  2 of 15 START sql view model pactravel_final.stg_pactravel__airlines ........... [RUN]
[0m14:03:51  2 of 15 OK created sql view model pactravel_final.stg_pactravel__airlines ...... [[32mCREATE VIEW[0m in 0.06s]
[0m14:03:51  3 of 15 START sql view model pactravel_final.stg_pactravel__airports ........... [RUN]
[0m14:03:51  3 of 15 OK created sql view model pactravel_final.stg_pactravel__airports ...... [[32mCREATE VIEW[0m in 0.05s]
[0m14:03:51  4 of 15 START sql view model pactravel_final.stg_pactravel__customers .......... [RUN]
[0m14:03:51  4 of 15 OK created sql view model pactravel_final.stg_pactravel__customers ..... [[32mCREATE VIEW[0m in 0.05s]
[0m14:03:51  5 of 15 START sql view model pactravel_final.stg_pactravel__flight_bookings .... [RUN]
[0m14:03:51  5 of 15 OK created sql view model pactravel_final.stg_pactravel__flight_bookings  [[32mCREATE VIEW[0m in 0.05s]
[0m14:03:51  6 of 15 START sql view model pactravel_final.stg_pactravel__hotel .............. [RUN]
[0m14:03:51  6 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel ......... [[32mCREATE VIEW[0m in 0.05s]
[0m14:03:51  7 of 15 START sql view model pactravel_final.stg_pactravel__hotel_bookings ..... [RUN]
[0m14:03:51  7 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel_bookings  [[32mCREATE VIEW[0m in 0.05s]
[0m14:03:51  8 of 15 START sql table model pactravel_final.dim_aircrafts .................... [RUN]
[0m14:03:51  8 of 15 OK created sql table model pactravel_final.dim_aircrafts ............... [[32mSELECT 246[0m in 0.11s]
[0m14:03:51  9 of 15 START sql table model pactravel_final.dim_airlines ..................... [RUN]
[0m14:03:51  9 of 15 OK created sql table model pactravel_final.dim_airlines ................ [[32mSELECT 1251[0m in 0.07s]
[0m14:03:51  10 of 15 START sql table model pactravel_final.dim_airports .................... [RUN]
[0m14:03:51  10 of 15 OK created sql table model pactravel_final.dim_airports ............... [[32mSELECT 105[0m in 0.06s]
[0m14:03:51  11 of 15 START sql table model pactravel_final.dim_customers ................... [RUN]
[0m14:03:51  11 of 15 OK created sql table model pactravel_final.dim_customers .............. [[32mSELECT 1000[0m in 0.07s]
[0m14:03:51  12 of 15 START sql table model pactravel_final.dim_hotel ....................... [RUN]
[0m14:03:52  12 of 15 OK created sql table model pactravel_final.dim_hotel .................. [[32mSELECT 1470[0m in 0.07s]
[0m14:03:52  13 of 15 START sql table model pactravel_final.fct_daily_revenue ............... [RUN]
[0m14:03:52  13 of 15 OK created sql table model pactravel_final.fct_daily_revenue .......... [[32mSELECT 2370[0m in 0.07s]
[0m14:03:52  14 of 15 START sql table model pactravel_final.fct_flight_bookings ............. [RUN]
[0m14:03:53  14 of 15 OK created sql table model pactravel_final.fct_flight_bookings ........ [[32mSELECT 8190[0m in 1.55s]
[0m14:03:53  15 of 15 START sql table model pactravel_final.fct_hotel_bookings .............. [RUN]
[0m14:03:54  15 of 15 OK created sql table model pactravel_final.fct_hotel_bookings ......... [[32mSELECT 217[0m in 0.62s]
[0m14:03:54  
[0m14:03:54  Running dbt Constraints
[0m14:03:54  Finished dbt Constraints
[0m14:03:54  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m14:03:54  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m14:03:54  
[0m14:03:54  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m14:03:54  
[0m14:03:54  [32mCompleted successfully[0m
[0m14:03:54  
[0m14:03:54  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m14:03:57  Running with dbt=1.9.0-b4
[0m14:03:57  Registered adapter: postgres=1.8.2
[0m14:03:58  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m14:03:58  
[0m14:03:58  Concurrency: 1 threads (target='dev')
[0m14:03:58  
[0m14:03:58  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m14:03:58  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mSELECT 1251[0m in 0.13s]
[0m14:03:58  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m14:03:58  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mSELECT 1000[0m in 0.05s]
[0m14:03:58  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m14:03:58  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mSELECT 1470[0m in 0.05s]
[0m14:03:58  
[0m14:03:58  Running dbt Constraints
[0m14:03:58  Finished dbt Constraints
[0m14:03:58  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m14:03:58  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m14:03:58  
[0m14:03:58  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m14:03:58  
[0m14:03:58  [32mCompleted successfully[0m
[0m14:03:58  
[0m14:03:58  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:04:01  Running with dbt=1.9.0-b4
[0m14:04:01  Registered adapter: postgres=1.8.2
[0m14:04:01  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m14:04:02  
[0m14:04:02  Concurrency: 1 threads (target='dev')
[0m14:04:02  
[0m14:04:02  1 of 47 START test dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [RUN]
[0m14:04:02  1 of 47 PASS dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.07s]
[0m14:04:02  2 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m14:04:02  2 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.03s]
[0m14:04:02  3 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m14:04:02  3 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m14:04:02  4 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m14:04:02  4 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m14:04:02  5 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m14:04:02  5 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m14:04:02  6 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m14:04:02  6 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m14:04:02  7 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m14:04:02  7 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m14:04:02  8 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m14:04:02  8 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m14:04:02  9 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m14:04:02  9 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m14:04:02  10 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m14:04:02  10 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m14:04:02  11 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m14:04:02  11 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.03s]
[0m14:04:02  12 of 47 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m14:04:02  12 of 47 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m14:04:02  13 of 47 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m14:04:02  13 of 47 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m14:04:02  14 of 47 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m14:04:02  14 of 47 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m14:04:02  15 of 47 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m14:04:02  15 of 47 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m14:04:02  16 of 47 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m14:04:02  16 of 47 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.04s]
[0m14:04:02  17 of 47 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m14:04:02  17 of 47 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m14:04:02  18 of 47 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m14:04:02  18 of 47 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.03s]
[0m14:04:02  19 of 47 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m14:04:02  19 of 47 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.03s]
[0m14:04:02  20 of 47 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m14:04:02  20 of 47 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m14:04:02  21 of 47 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m14:04:02  21 of 47 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m14:04:02  22 of 47 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m14:04:02  22 of 47 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m14:04:02  23 of 47 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m14:04:02  23 of 47 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m14:04:02  24 of 47 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m14:04:03  24 of 47 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m14:04:03  25 of 47 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m14:04:03  25 of 47 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m14:04:03  26 of 47 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m14:04:03  26 of 47 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m14:04:03  27 of 47 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m14:04:03  27 of 47 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m14:04:03  28 of 47 START test not_null_dim_date_date_id .................................. [RUN]
[0m14:04:03  28 of 47 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m14:04:03  29 of 47 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m14:04:03  29 of 47 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m14:04:03  30 of 47 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m14:04:03  30 of 47 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m14:04:03  31 of 47 START test not_null_fct_daily_revenue_booking_date .................... [RUN]
[0m14:04:03  31 of 47 PASS not_null_fct_daily_revenue_booking_date .......................... [[32mPASS[0m in 0.03s]
[0m14:04:03  32 of 47 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m14:04:03  32 of 47 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.03s]
[0m14:04:03  33 of 47 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m14:04:03  33 of 47 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m14:04:03  34 of 47 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m14:04:03  34 of 47 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.08s]
[0m14:04:03  35 of 47 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m14:04:03  35 of 47 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m14:04:03  36 of 47 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m14:04:03  36 of 47 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m14:04:03  37 of 47 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m14:04:03  37 of 47 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m14:04:03  38 of 47 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m14:04:03  38 of 47 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m14:04:03  39 of 47 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m14:04:03  39 of 47 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.03s]
[0m14:04:03  40 of 47 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m14:04:03  40 of 47 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m14:04:03  41 of 47 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m14:04:03  41 of 47 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m14:04:03  42 of 47 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m14:04:03  42 of 47 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.03s]
[0m14:04:03  43 of 47 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m14:04:03  43 of 47 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m14:04:03  44 of 47 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m14:04:03  44 of 47 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m14:04:03  45 of 47 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m14:04:03  45 of 47 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.03s]
[0m14:04:03  46 of 47 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m14:04:03  46 of 47 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m14:04:03  47 of 47 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m14:04:03  47 of 47 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m14:04:03  
[0m14:04:03  Running dbt Constraints
[0m14:04:03  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m14:04:03  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m14:04:03  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m14:04:03  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m14:04:03  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m14:04:03  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m14:04:03  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m14:04:03  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m14:04:03  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m14:04:03  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m14:04:03  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m14:04:04  Creating not null constraint for: booking_date in "pactravel-dwh"."pactravel_final"."fct_daily_revenue"
[0m14:04:04  Creating not null constraint for: aircraft_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: airline_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: arrival_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: departure_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: departure_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating not null constraint for: check_in_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: check_out_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: hotel_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m14:04:04  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m14:04:04  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m14:04:04  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m14:04:04  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m14:04:04  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m14:04:04  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m14:04:04  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m14:04:04  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m14:04:04  Creating primary key: DIM_DATE_DATE_ID_PK
[0m14:04:04  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m14:04:04  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m14:04:04  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m14:04:04  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m14:04:04  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m14:04:04  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m14:04:04  Skipping FCT_DAILY_REVENUE_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m14:04:04  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_aircrafts" ['nk_aircraft_id']
[0m14:04:04  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airlines" ['nk_airline_id']
[0m14:04:04  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m14:04:04  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m14:04:04  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m14:04:04  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m14:04:04  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m14:04:04  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m14:04:04  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m14:04:04  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_hotel" ['nk_hotel_id']
[0m14:04:04  Finished dbt Constraints
[0m14:04:04  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m14:04:04  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.88s]
[0m14:04:04  
[0m14:04:04  Finished running 1 project hook, 47 data tests in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m14:04:04  
[0m14:04:04  [32mCompleted successfully[0m
[0m14:04:04  
[0m14:04:04  Done. PASS=48 WARN=0 ERROR=0 SKIP=0 TOTAL=48
2024-11-08 21:04:06,287 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2024-11-08 21:04:06,287 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2024-11-08 21:04:06,287 - INFO - [pid 74098] Worker Worker(salt=8389341441, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=74098) done      Transform()
2024-11-08 21:04:06,287 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-08 21:04:06,290 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2024-11-08 21:04:06,290 - DEBUG - Asking scheduler for work...
2024-11-08 21:04:06,292 - DEBUG - Done
2024-11-08 21:04:06,293 - DEBUG - There are no more tasks to run at this time
2024-11-08 21:04:06,293 - INFO - Worker Worker(salt=8389341441, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=74098) was stopped. Shutting down Keep-Alive thread
2024-11-08 21:04:06,294 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2024-11-09 02:47:47,708 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-09 02:47:47,809 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-09 02:47:47,826 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-09 02:47:47,835 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-09 02:47:47,851 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-09 02:47:47,881 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-09 02:47:47,989 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-09 02:47:47,997 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-09 02:47:47,997 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-09 02:47:48,016 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-09 02:47:48,016 - INFO - [pid 90029] Worker Worker(salt=5850902754, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=90029) done      Extract()
2024-11-09 02:47:48,018 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:47:48,023 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-09 02:47:48,023 - DEBUG - Asking scheduler for work...
2024-11-09 02:47:48,026 - DEBUG - Pending tasks: 2
2024-11-09 02:47:48,026 - INFO - [pid 90029] Worker Worker(salt=5850902754, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=90029) running   Load()
2024-11-09 02:47:48,029 - INFO - Read Load Query - SUCCESS!
2024-11-09 02:47:48,072 - INFO - Read Extracted Data - SUCCESS!
2024-11-09 02:47:48,073 - INFO - Connect to DWH - SUCCESS!
2024-11-09 02:47:48,226 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-09 02:47:48,226 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-09 02:47:48,271 - INFO - Load aircrafts table - SUCCESS!
2024-11-09 02:47:48,390 - INFO - Load airlines table - SUCCESS!
2024-11-09 02:47:48,409 - INFO - Load airports table - SUCCESS!
2024-11-09 02:47:48,456 - INFO - Load customers table - SUCCESS!
2024-11-09 02:47:48,534 - INFO - Load hotel table - SUCCESS!
2024-11-09 02:47:49,309 - INFO - Load flight_bookings table - SUCCESS!
2024-11-09 02:47:49,331 - INFO - Load hotel_bookings table - SUCCESS!
2024-11-09 02:47:49,332 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-09 02:47:49,962 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-09 02:47:49,964 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-09 02:47:49,967 - INFO - [pid 90029] Worker Worker(salt=5850902754, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=90029) done      Load()
2024-11-09 02:47:49,967 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:47:49,970 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-09 02:47:49,970 - DEBUG - Asking scheduler for work...
2024-11-09 02:47:49,972 - DEBUG - Pending tasks: 1
2024-11-09 02:47:49,973 - INFO - [pid 90029] Worker Worker(salt=5850902754, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=90029) running   Transform()
2024-11-09 02:47:49,973 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m19:47:51  Running with dbt=1.9.0-b4
[0m19:47:52  Installing dbt-labs/dbt_utils
[0m19:47:53  Installed from version 1.1.1
[0m19:47:53  Updated version available: 1.3.0
[0m19:47:53  Installing calogica/dbt_date
[0m19:47:53  Installed from version 0.10.0
[0m19:47:53  Updated version available: 0.10.1
[0m19:47:53  Installing Snowflake-Labs/dbt_constraints
[0m19:47:54  Installed from version 0.6.3
[0m19:47:54  Updated version available: 1.0.4
[0m19:47:54  
[0m19:47:54  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m19:47:57  Running with dbt=1.9.0-b4
[0m19:47:57  Registered adapter: postgres=1.8.2
[0m19:47:57  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:47:57  
[0m19:47:57  Concurrency: 1 threads (target='dev')
[0m19:47:57  
[0m19:47:58  1 of 1 START seed file pactravel_final.dim_date ................................ [RUN]
[0m19:50:17  1 of 1 OK loaded seed file pactravel_final.dim_date ............................ [[32mINSERT 29220[0m in 138.98s]
[0m19:50:17  
[0m19:50:17  Running dbt Constraints
[0m19:50:17  Finished dbt Constraints
[0m19:50:17  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:50:17  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.06s]
[0m19:50:17  
[0m19:50:17  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 19.34 seconds (139.34s).
[0m19:50:17  
[0m19:50:17  [32mCompleted successfully[0m
[0m19:50:17  
[0m19:50:17  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:50:19  Running with dbt=1.9.0-b4
[0m19:50:20  Registered adapter: postgres=1.8.2
[0m19:50:20  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:50:20  
[0m19:50:20  Concurrency: 1 threads (target='dev')
[0m19:50:20  
[0m19:50:20  1 of 15 START sql view model pactravel_final.stg_pactravel__aircrafts .......... [RUN]
[0m19:50:21  1 of 15 OK created sql view model pactravel_final.stg_pactravel__aircrafts ..... [[32mCREATE VIEW[0m in 0.14s]
[0m19:50:21  2 of 15 START sql view model pactravel_final.stg_pactravel__airlines ........... [RUN]
[0m19:50:21  2 of 15 OK created sql view model pactravel_final.stg_pactravel__airlines ...... [[32mCREATE VIEW[0m in 0.05s]
[0m19:50:21  3 of 15 START sql view model pactravel_final.stg_pactravel__airports ........... [RUN]
[0m19:50:21  3 of 15 OK created sql view model pactravel_final.stg_pactravel__airports ...... [[32mCREATE VIEW[0m in 0.05s]
[0m19:50:21  4 of 15 START sql view model pactravel_final.stg_pactravel__customers .......... [RUN]
[0m19:50:21  4 of 15 OK created sql view model pactravel_final.stg_pactravel__customers ..... [[32mCREATE VIEW[0m in 0.05s]
[0m19:50:21  5 of 15 START sql view model pactravel_final.stg_pactravel__flight_bookings .... [RUN]
[0m19:50:21  5 of 15 OK created sql view model pactravel_final.stg_pactravel__flight_bookings  [[32mCREATE VIEW[0m in 0.06s]
[0m19:50:21  6 of 15 START sql view model pactravel_final.stg_pactravel__hotel .............. [RUN]
[0m19:50:21  6 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel ......... [[32mCREATE VIEW[0m in 0.05s]
[0m19:50:21  7 of 15 START sql view model pactravel_final.stg_pactravel__hotel_bookings ..... [RUN]
[0m19:50:21  7 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel_bookings  [[32mCREATE VIEW[0m in 0.05s]
[0m19:50:21  8 of 15 START sql table model pactravel_final.dim_aircrafts .................... [RUN]
[0m19:50:21  8 of 15 OK created sql table model pactravel_final.dim_aircrafts ............... [[32mSELECT 246[0m in 0.10s]
[0m19:50:21  9 of 15 START sql table model pactravel_final.dim_airlines ..................... [RUN]
[0m19:50:21  9 of 15 OK created sql table model pactravel_final.dim_airlines ................ [[32mSELECT 1251[0m in 0.07s]
[0m19:50:21  10 of 15 START sql table model pactravel_final.dim_airports .................... [RUN]
[0m19:50:21  10 of 15 OK created sql table model pactravel_final.dim_airports ............... [[32mSELECT 105[0m in 0.06s]
[0m19:50:21  11 of 15 START sql table model pactravel_final.dim_customers ................... [RUN]
[0m19:50:21  11 of 15 OK created sql table model pactravel_final.dim_customers .............. [[32mSELECT 1000[0m in 0.06s]
[0m19:50:21  12 of 15 START sql table model pactravel_final.dim_hotel ....................... [RUN]
[0m19:50:21  12 of 15 OK created sql table model pactravel_final.dim_hotel .................. [[32mSELECT 1470[0m in 0.07s]
[0m19:50:21  13 of 15 START sql table model pactravel_final.fct_daily_revenue ............... [RUN]
[0m19:50:21  13 of 15 OK created sql table model pactravel_final.fct_daily_revenue .......... [[32mSELECT 2395[0m in 0.08s]
[0m19:50:21  14 of 15 START sql table model pactravel_final.fct_flight_bookings ............. [RUN]
[0m19:50:23  14 of 15 OK created sql table model pactravel_final.fct_flight_bookings ........ [[32mSELECT 8190[0m in 1.51s]
[0m19:50:23  15 of 15 START sql table model pactravel_final.fct_hotel_bookings .............. [RUN]
[0m19:50:24  15 of 15 OK created sql table model pactravel_final.fct_hotel_bookings ......... [[32mSELECT 217[0m in 0.62s]
[0m19:50:24  
[0m19:50:24  Running dbt Constraints
[0m19:50:24  Finished dbt Constraints
[0m19:50:24  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:50:24  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m19:50:24  
[0m19:50:24  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m19:50:24  
[0m19:50:24  [32mCompleted successfully[0m
[0m19:50:24  
[0m19:50:24  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m19:50:27  Running with dbt=1.9.0-b4
[0m19:50:27  Registered adapter: postgres=1.8.2
[0m19:50:27  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:50:27  
[0m19:50:27  Concurrency: 1 threads (target='dev')
[0m19:50:27  
[0m19:50:28  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m19:50:28  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mSELECT 1251[0m in 0.15s]
[0m19:50:28  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m19:50:28  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mSELECT 1000[0m in 0.07s]
[0m19:50:28  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m19:50:28  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mSELECT 1470[0m in 0.05s]
[0m19:50:28  
[0m19:50:28  Running dbt Constraints
[0m19:50:28  Finished dbt Constraints
[0m19:50:28  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:50:28  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m19:50:28  
[0m19:50:28  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m19:50:28  
[0m19:50:28  [32mCompleted successfully[0m
[0m19:50:28  
[0m19:50:28  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:50:31  Running with dbt=1.9.0-b4
[0m19:50:31  Registered adapter: postgres=1.8.2
[0m19:50:32  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:50:32  
[0m19:50:32  Concurrency: 1 threads (target='dev')
[0m19:50:32  
[0m19:50:32  1 of 47 START test dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [RUN]
[0m19:50:32  1 of 47 PASS dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.07s]
[0m19:50:32  2 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m19:50:32  2 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.03s]
[0m19:50:32  3 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m19:50:32  3 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m19:50:32  4 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m19:50:32  4 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.04s]
[0m19:50:32  5 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m19:50:32  5 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m19:50:32  6 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m19:50:32  6 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:50:32  7 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m19:50:32  7 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m19:50:32  8 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m19:50:32  8 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m19:50:32  9 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m19:50:32  9 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:50:32  10 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m19:50:32  10 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:50:32  11 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m19:50:32  11 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.03s]
[0m19:50:32  12 of 47 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m19:50:32  12 of 47 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m19:50:32  13 of 47 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m19:50:32  13 of 47 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m19:50:32  14 of 47 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m19:50:32  14 of 47 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m19:50:32  15 of 47 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m19:50:32  15 of 47 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m19:50:32  16 of 47 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m19:50:32  16 of 47 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.04s]
[0m19:50:32  17 of 47 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m19:50:32  17 of 47 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m19:50:32  18 of 47 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m19:50:32  18 of 47 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.03s]
[0m19:50:32  19 of 47 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m19:50:32  19 of 47 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.03s]
[0m19:50:32  20 of 47 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m19:50:32  20 of 47 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m19:50:32  21 of 47 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m19:50:32  21 of 47 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m19:50:32  22 of 47 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m19:50:32  22 of 47 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m19:50:32  23 of 47 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m19:50:33  23 of 47 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.04s]
[0m19:50:33  24 of 47 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m19:50:33  24 of 47 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m19:50:33  25 of 47 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m19:50:33  25 of 47 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.05s]
[0m19:50:33  26 of 47 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m19:50:33  26 of 47 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.04s]
[0m19:50:33  27 of 47 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m19:50:33  27 of 47 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m19:50:33  28 of 47 START test not_null_dim_date_date_id .................................. [RUN]
[0m19:50:33  28 of 47 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m19:50:33  29 of 47 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m19:50:33  29 of 47 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m19:50:33  30 of 47 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m19:50:33  30 of 47 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.02s]
[0m19:50:33  31 of 47 START test not_null_fct_daily_revenue_booking_date .................... [RUN]
[0m19:50:33  31 of 47 PASS not_null_fct_daily_revenue_booking_date .......................... [[32mPASS[0m in 0.03s]
[0m19:50:33  32 of 47 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m19:50:33  32 of 47 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.03s]
[0m19:50:33  33 of 47 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m19:50:33  33 of 47 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m19:50:33  34 of 47 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m19:50:33  34 of 47 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.10s]
[0m19:50:33  35 of 47 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m19:50:33  35 of 47 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m19:50:33  36 of 47 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m19:50:33  36 of 47 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m19:50:33  37 of 47 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m19:50:33  37 of 47 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m19:50:33  38 of 47 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m19:50:33  38 of 47 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m19:50:33  39 of 47 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m19:50:33  39 of 47 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.03s]
[0m19:50:33  40 of 47 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m19:50:33  40 of 47 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m19:50:33  41 of 47 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m19:50:33  41 of 47 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m19:50:33  42 of 47 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m19:50:33  42 of 47 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.03s]
[0m19:50:33  43 of 47 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m19:50:33  43 of 47 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m19:50:33  44 of 47 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m19:50:33  44 of 47 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m19:50:33  45 of 47 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m19:50:33  45 of 47 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.03s]
[0m19:50:33  46 of 47 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m19:50:33  46 of 47 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m19:50:33  47 of 47 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m19:50:33  47 of 47 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m19:50:33  
[0m19:50:33  Running dbt Constraints
[0m19:50:33  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m19:50:33  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m19:50:34  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m19:50:34  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m19:50:34  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m19:50:34  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m19:50:34  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m19:50:34  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m19:50:34  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m19:50:34  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m19:50:34  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m19:50:34  Creating not null constraint for: booking_date in "pactravel-dwh"."pactravel_final"."fct_daily_revenue"
[0m19:50:34  Creating not null constraint for: aircraft_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: airline_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: arrival_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: departure_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: departure_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating not null constraint for: check_in_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: check_out_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: hotel_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m19:50:34  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m19:50:34  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m19:50:34  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m19:50:34  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m19:50:34  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m19:50:34  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m19:50:34  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m19:50:34  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m19:50:34  Creating primary key: DIM_DATE_DATE_ID_PK
[0m19:50:34  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m19:50:34  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m19:50:34  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:50:34  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m19:50:34  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:50:34  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m19:50:34  Skipping FCT_DAILY_REVENUE_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:50:34  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_aircrafts" ['nk_aircraft_id']
[0m19:50:34  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airlines" ['nk_airline_id']
[0m19:50:34  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m19:50:34  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m19:50:34  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:50:34  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:50:34  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:50:34  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:50:34  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:50:34  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_hotel" ['nk_hotel_id']
[0m19:50:34  Finished dbt Constraints
[0m19:50:34  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:50:34  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.93s]
[0m19:50:34  
[0m19:50:34  Finished running 1 project hook, 47 data tests in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m19:50:34  
[0m19:50:34  [32mCompleted successfully[0m
[0m19:50:34  
[0m19:50:34  Done. PASS=48 WARN=0 ERROR=0 SKIP=0 TOTAL=48
2024-11-09 02:50:36,187 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2024-11-09 02:50:36,187 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2024-11-09 02:50:36,187 - INFO - [pid 90029] Worker Worker(salt=5850902754, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=90029) done      Transform()
2024-11-09 02:50:36,188 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:50:36,191 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2024-11-09 02:50:36,191 - DEBUG - Asking scheduler for work...
2024-11-09 02:50:36,193 - DEBUG - Done
2024-11-09 02:50:36,193 - DEBUG - There are no more tasks to run at this time
2024-11-09 02:50:36,193 - INFO - Worker Worker(salt=5850902754, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=90029) was stopped. Shutting down Keep-Alive thread
2024-11-09 02:50:36,195 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2024-11-09 02:52:34,258 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-09 02:52:34,292 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-09 02:52:34,303 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-09 02:52:34,308 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-09 02:52:34,317 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-09 02:52:34,334 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-09 02:52:34,420 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-09 02:52:34,426 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-09 02:52:34,426 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-09 02:52:34,428 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-09 02:52:34,428 - INFO - [pid 92544] Worker Worker(salt=6964129367, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=92544) done      Extract()
2024-11-09 02:52:34,428 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:52:34,431 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-09 02:52:34,432 - DEBUG - Asking scheduler for work...
2024-11-09 02:52:34,433 - DEBUG - Pending tasks: 2
2024-11-09 02:52:34,434 - INFO - [pid 92544] Worker Worker(salt=6964129367, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=92544) running   Load()
2024-11-09 02:52:34,434 - INFO - Read Load Query - SUCCESS!
2024-11-09 02:52:34,457 - INFO - Read Extracted Data - SUCCESS!
2024-11-09 02:52:34,457 - INFO - Connect to DWH - SUCCESS!
2024-11-09 02:52:34,578 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-09 02:52:34,579 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-09 02:52:34,616 - INFO - Load aircrafts table - SUCCESS!
2024-11-09 02:52:34,649 - INFO - Load airlines table - SUCCESS!
2024-11-09 02:52:34,660 - INFO - Load airports table - SUCCESS!
2024-11-09 02:52:34,688 - INFO - Load customers table - SUCCESS!
2024-11-09 02:52:34,729 - INFO - Load hotel table - SUCCESS!
2024-11-09 02:52:35,316 - INFO - Load flight_bookings table - SUCCESS!
2024-11-09 02:52:35,332 - INFO - Load hotel_bookings table - SUCCESS!
2024-11-09 02:52:35,332 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-09 02:52:35,541 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-09 02:52:35,543 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-09 02:52:35,543 - INFO - [pid 92544] Worker Worker(salt=6964129367, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=92544) done      Load()
2024-11-09 02:52:35,544 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:52:35,547 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-09 02:52:35,547 - DEBUG - Asking scheduler for work...
2024-11-09 02:52:35,552 - DEBUG - Pending tasks: 1
2024-11-09 02:52:35,552 - INFO - [pid 92544] Worker Worker(salt=6964129367, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=92544) running   Transform()
2024-11-09 02:52:35,553 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m19:52:36  Running with dbt=1.9.0-b4
[0m19:52:38  Installing dbt-labs/dbt_utils
[0m19:52:40  Installed from version 1.1.1
[0m19:52:40  Updated version available: 1.3.0
[0m19:52:40  Installing calogica/dbt_date
[0m19:52:40  Installed from version 0.10.0
[0m19:52:40  Updated version available: 0.10.1
[0m19:52:40  Installing Snowflake-Labs/dbt_constraints
[0m19:52:41  Installed from version 0.6.3
[0m19:52:41  Updated version available: 1.0.4
[0m19:52:41  
[0m19:52:41  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m19:52:43  Running with dbt=1.9.0-b4
[0m19:52:44  Registered adapter: postgres=1.8.2
[0m19:52:44  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:52:44  
[0m19:52:44  Concurrency: 1 threads (target='dev')
[0m19:52:44  
[0m19:52:44  1 of 1 START seed file pactravel_final.dim_date ................................ [RUN]
[0m19:54:58  1 of 1 OK loaded seed file pactravel_final.dim_date ............................ [[32mINSERT 29220[0m in 133.82s]
[0m19:54:58  
[0m19:54:58  Running dbt Constraints
[0m19:54:58  Finished dbt Constraints
[0m19:54:58  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:54:58  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m19:54:58  
[0m19:54:58  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 14.09 seconds (134.09s).
[0m19:54:58  
[0m19:54:58  [32mCompleted successfully[0m
[0m19:54:58  
[0m19:54:58  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:55:01  Running with dbt=1.9.0-b4
[0m19:55:01  Registered adapter: postgres=1.8.2
[0m19:55:02  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:55:02  
[0m19:55:02  Concurrency: 1 threads (target='dev')
[0m19:55:02  
[0m19:55:02  1 of 15 START sql view model pactravel_final.stg_pactravel__aircrafts .......... [RUN]
[0m19:55:02  1 of 15 OK created sql view model pactravel_final.stg_pactravel__aircrafts ..... [[32mCREATE VIEW[0m in 0.12s]
[0m19:55:02  2 of 15 START sql view model pactravel_final.stg_pactravel__airlines ........... [RUN]
[0m19:55:02  2 of 15 OK created sql view model pactravel_final.stg_pactravel__airlines ...... [[32mCREATE VIEW[0m in 0.05s]
[0m19:55:02  3 of 15 START sql view model pactravel_final.stg_pactravel__airports ........... [RUN]
[0m19:55:02  3 of 15 OK created sql view model pactravel_final.stg_pactravel__airports ...... [[32mCREATE VIEW[0m in 0.06s]
[0m19:55:02  4 of 15 START sql view model pactravel_final.stg_pactravel__customers .......... [RUN]
[0m19:55:02  4 of 15 OK created sql view model pactravel_final.stg_pactravel__customers ..... [[32mCREATE VIEW[0m in 0.07s]
[0m19:55:02  5 of 15 START sql view model pactravel_final.stg_pactravel__flight_bookings .... [RUN]
[0m19:55:02  5 of 15 OK created sql view model pactravel_final.stg_pactravel__flight_bookings  [[32mCREATE VIEW[0m in 0.05s]
[0m19:55:02  6 of 15 START sql view model pactravel_final.stg_pactravel__hotel .............. [RUN]
[0m19:55:02  6 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel ......... [[32mCREATE VIEW[0m in 0.06s]
[0m19:55:02  7 of 15 START sql view model pactravel_final.stg_pactravel__hotel_bookings ..... [RUN]
[0m19:55:02  7 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel_bookings  [[32mCREATE VIEW[0m in 0.06s]
[0m19:55:02  8 of 15 START sql table model pactravel_final.dim_aircrafts .................... [RUN]
[0m19:55:02  8 of 15 OK created sql table model pactravel_final.dim_aircrafts ............... [[32mSELECT 246[0m in 0.11s]
[0m19:55:02  9 of 15 START sql table model pactravel_final.dim_airlines ..................... [RUN]
[0m19:55:02  9 of 15 OK created sql table model pactravel_final.dim_airlines ................ [[32mSELECT 1251[0m in 0.09s]
[0m19:55:02  10 of 15 START sql table model pactravel_final.dim_airports .................... [RUN]
[0m19:55:03  10 of 15 OK created sql table model pactravel_final.dim_airports ............... [[32mSELECT 105[0m in 0.08s]
[0m19:55:03  11 of 15 START sql table model pactravel_final.dim_customers ................... [RUN]
[0m19:55:03  11 of 15 OK created sql table model pactravel_final.dim_customers .............. [[32mSELECT 1000[0m in 0.13s]
[0m19:55:03  12 of 15 START sql table model pactravel_final.dim_hotel ....................... [RUN]
[0m19:55:03  12 of 15 OK created sql table model pactravel_final.dim_hotel .................. [[32mSELECT 1470[0m in 0.08s]
[0m19:55:03  13 of 15 START sql table model pactravel_final.fct_daily_revenue ............... [RUN]
[0m19:55:03  13 of 15 OK created sql table model pactravel_final.fct_daily_revenue .......... [[32mSELECT 2393[0m in 0.08s]
[0m19:55:03  14 of 15 START sql table model pactravel_final.fct_flight_bookings ............. [RUN]
[0m19:55:04  14 of 15 OK created sql table model pactravel_final.fct_flight_bookings ........ [[32mSELECT 8190[0m in 0.94s]
[0m19:55:04  15 of 15 START sql table model pactravel_final.fct_hotel_bookings .............. [RUN]
[0m19:55:04  15 of 15 OK created sql table model pactravel_final.fct_hotel_bookings ......... [[32mSELECT 217[0m in 0.62s]
[0m19:55:04  
[0m19:55:04  Running dbt Constraints
[0m19:55:04  Finished dbt Constraints
[0m19:55:04  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:55:04  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m19:55:04  
[0m19:55:04  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m19:55:05  
[0m19:55:05  [32mCompleted successfully[0m
[0m19:55:05  
[0m19:55:05  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m19:55:07  Running with dbt=1.9.0-b4
[0m19:55:07  Registered adapter: postgres=1.8.2
[0m19:55:08  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:55:08  
[0m19:55:08  Concurrency: 1 threads (target='dev')
[0m19:55:08  
[0m19:55:08  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m19:55:08  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mINSERT 0 1251[0m in 0.23s]
[0m19:55:08  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m19:55:08  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mINSERT 0 1000[0m in 0.11s]
[0m19:55:08  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m19:55:09  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mINSERT 0 1470[0m in 0.12s]
[0m19:55:09  
[0m19:55:09  Running dbt Constraints
[0m19:55:09  Finished dbt Constraints
[0m19:55:09  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:55:09  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m19:55:09  
[0m19:55:09  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m19:55:09  
[0m19:55:09  [32mCompleted successfully[0m
[0m19:55:09  
[0m19:55:09  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:55:11  Running with dbt=1.9.0-b4
[0m19:55:11  Registered adapter: postgres=1.8.2
[0m19:55:12  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:55:12  
[0m19:55:12  Concurrency: 1 threads (target='dev')
[0m19:55:12  
[0m19:55:12  1 of 47 START test dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [RUN]
[0m19:55:12  1 of 47 PASS dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.07s]
[0m19:55:12  2 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m19:55:12  2 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.04s]
[0m19:55:12  3 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m19:55:12  3 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m19:55:12  4 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m19:55:12  4 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m19:55:12  5 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m19:55:12  5 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m19:55:12  6 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m19:55:12  6 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.04s]
[0m19:55:12  7 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m19:55:12  7 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:55:12  8 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m19:55:12  8 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:55:12  9 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m19:55:12  9 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:55:12  10 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m19:55:12  10 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m19:55:12  11 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m19:55:12  11 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.03s]
[0m19:55:12  12 of 47 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m19:55:12  12 of 47 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m19:55:12  13 of 47 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m19:55:12  13 of 47 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m19:55:12  14 of 47 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m19:55:13  14 of 47 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m19:55:13  15 of 47 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m19:55:13  15 of 47 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m19:55:13  16 of 47 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m19:55:13  16 of 47 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.04s]
[0m19:55:13  17 of 47 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m19:55:13  17 of 47 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m19:55:13  18 of 47 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m19:55:13  18 of 47 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.03s]
[0m19:55:13  19 of 47 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m19:55:13  19 of 47 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.03s]
[0m19:55:13  20 of 47 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m19:55:13  20 of 47 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m19:55:13  21 of 47 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m19:55:13  21 of 47 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m19:55:13  22 of 47 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m19:55:13  22 of 47 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m19:55:13  23 of 47 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m19:55:13  23 of 47 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.02s]
[0m19:55:13  24 of 47 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m19:55:13  24 of 47 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m19:55:13  25 of 47 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m19:55:13  25 of 47 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m19:55:13  26 of 47 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m19:55:13  26 of 47 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m19:55:13  27 of 47 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m19:55:13  27 of 47 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m19:55:13  28 of 47 START test not_null_dim_date_date_id .................................. [RUN]
[0m19:55:13  28 of 47 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m19:55:13  29 of 47 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m19:55:13  29 of 47 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m19:55:13  30 of 47 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m19:55:13  30 of 47 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.02s]
[0m19:55:13  31 of 47 START test not_null_fct_daily_revenue_booking_date .................... [RUN]
[0m19:55:13  31 of 47 PASS not_null_fct_daily_revenue_booking_date .......................... [[32mPASS[0m in 0.03s]
[0m19:55:13  32 of 47 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m19:55:13  32 of 47 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.03s]
[0m19:55:13  33 of 47 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m19:55:13  33 of 47 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m19:55:13  34 of 47 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m19:55:13  34 of 47 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.07s]
[0m19:55:13  35 of 47 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m19:55:13  35 of 47 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m19:55:13  36 of 47 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m19:55:13  36 of 47 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m19:55:13  37 of 47 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m19:55:13  37 of 47 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m19:55:13  38 of 47 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m19:55:13  38 of 47 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m19:55:13  39 of 47 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m19:55:13  39 of 47 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.03s]
[0m19:55:13  40 of 47 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m19:55:13  40 of 47 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m19:55:13  41 of 47 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m19:55:13  41 of 47 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m19:55:13  42 of 47 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m19:55:13  42 of 47 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.02s]
[0m19:55:13  43 of 47 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m19:55:13  43 of 47 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m19:55:13  44 of 47 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m19:55:13  44 of 47 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.03s]
[0m19:55:13  45 of 47 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m19:55:13  45 of 47 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.02s]
[0m19:55:13  46 of 47 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m19:55:13  46 of 47 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m19:55:13  47 of 47 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m19:55:14  47 of 47 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.02s]
[0m19:55:14  
[0m19:55:14  Running dbt Constraints
[0m19:55:14  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m19:55:14  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m19:55:14  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m19:55:14  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m19:55:14  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m19:55:14  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m19:55:14  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m19:55:14  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m19:55:14  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m19:55:14  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m19:55:14  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m19:55:14  Creating not null constraint for: booking_date in "pactravel-dwh"."pactravel_final"."fct_daily_revenue"
[0m19:55:14  Creating not null constraint for: aircraft_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: airline_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: arrival_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: departure_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: departure_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating not null constraint for: check_in_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: check_out_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: hotel_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m19:55:14  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m19:55:14  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m19:55:14  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m19:55:14  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m19:55:14  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m19:55:14  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m19:55:14  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m19:55:14  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m19:55:14  Creating primary key: DIM_DATE_DATE_ID_PK
[0m19:55:14  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m19:55:14  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m19:55:14  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m19:55:14  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m19:55:14  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m19:55:14  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m19:55:14  Skipping FCT_DAILY_REVENUE_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:55:14  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_aircrafts" ['nk_aircraft_id']
[0m19:55:14  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airlines" ['nk_airline_id']
[0m19:55:14  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m19:55:14  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m19:55:14  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:55:14  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:55:14  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:55:14  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:55:14  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m19:55:14  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_hotel" ['nk_hotel_id']
[0m19:55:14  Finished dbt Constraints
[0m19:55:14  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m19:55:14  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.86s]
[0m19:55:14  
[0m19:55:14  Finished running 1 project hook, 47 data tests in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m19:55:14  
[0m19:55:14  [32mCompleted successfully[0m
[0m19:55:14  
[0m19:55:14  Done. PASS=48 WARN=0 ERROR=0 SKIP=0 TOTAL=48
2024-11-09 02:55:16,580 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2024-11-09 02:55:16,580 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2024-11-09 02:55:16,581 - INFO - [pid 92544] Worker Worker(salt=6964129367, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=92544) done      Transform()
2024-11-09 02:55:16,581 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:55:16,584 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2024-11-09 02:55:16,584 - DEBUG - Asking scheduler for work...
2024-11-09 02:55:16,586 - DEBUG - Done
2024-11-09 02:55:16,586 - DEBUG - There are no more tasks to run at this time
2024-11-09 02:55:16,586 - INFO - Worker Worker(salt=6964129367, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=92544) was stopped. Shutting down Keep-Alive thread
2024-11-09 02:55:16,587 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2024-11-09 02:57:49,952 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-09 02:57:49,985 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-09 02:57:49,996 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-09 02:57:50,001 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-09 02:57:50,010 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-09 02:57:50,023 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-09 02:57:50,086 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-09 02:57:50,092 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-09 02:57:50,092 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-09 02:57:50,093 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-09 02:57:50,094 - INFO - [pid 95190] Worker Worker(salt=8171597509, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=95190) done      Extract()
2024-11-09 02:57:50,095 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:57:50,098 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-09 02:57:50,098 - DEBUG - Asking scheduler for work...
2024-11-09 02:57:50,100 - DEBUG - Pending tasks: 2
2024-11-09 02:57:50,101 - INFO - [pid 95190] Worker Worker(salt=8171597509, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=95190) running   Load()
2024-11-09 02:57:50,101 - INFO - Read Load Query - SUCCESS!
2024-11-09 02:57:50,131 - INFO - Read Extracted Data - SUCCESS!
2024-11-09 02:57:50,132 - INFO - Connect to DWH - SUCCESS!
2024-11-09 02:57:50,285 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-09 02:57:50,285 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-09 02:57:50,299 - INFO - Load aircrafts table - SUCCESS!
2024-11-09 02:57:50,333 - INFO - Load airlines table - SUCCESS!
2024-11-09 02:57:50,343 - INFO - Load airports table - SUCCESS!
2024-11-09 02:57:50,371 - INFO - Load customers table - SUCCESS!
2024-11-09 02:57:50,409 - INFO - Load hotel table - SUCCESS!
2024-11-09 02:57:50,979 - INFO - Load flight_bookings table - SUCCESS!
2024-11-09 02:57:50,995 - INFO - Load hotel_bookings table - SUCCESS!
2024-11-09 02:57:50,995 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-09 02:57:51,173 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-09 02:57:51,174 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-09 02:57:51,175 - INFO - [pid 95190] Worker Worker(salt=8171597509, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=95190) done      Load()
2024-11-09 02:57:51,175 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 02:57:51,180 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-09 02:57:51,180 - DEBUG - Asking scheduler for work...
2024-11-09 02:57:51,183 - DEBUG - Pending tasks: 1
2024-11-09 02:57:51,183 - INFO - [pid 95190] Worker Worker(salt=8171597509, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=95190) running   Transform()
2024-11-09 02:57:51,184 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m19:57:52  Running with dbt=1.9.0-b4
[0m19:57:53  Installing dbt-labs/dbt_utils
[0m19:57:54  Installed from version 1.1.1
[0m19:57:54  Updated version available: 1.3.0
[0m19:57:54  Installing calogica/dbt_date
[0m19:57:54  Installed from version 0.10.0
[0m19:57:54  Updated version available: 0.10.1
[0m19:57:54  Installing Snowflake-Labs/dbt_constraints
[0m19:57:55  Installed from version 0.6.3
[0m19:57:55  Updated version available: 1.0.4
[0m19:57:55  
[0m19:57:55  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m19:57:58  Running with dbt=1.9.0-b4
[0m19:57:58  Registered adapter: postgres=1.8.2
[0m19:57:58  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m19:57:58  
[0m19:57:58  Concurrency: 1 threads (target='dev')
[0m19:57:58  
[0m19:57:59  1 of 1 START seed file pactravel_final.dim_date ................................ [RUN]
[0m20:00:12  1 of 1 OK loaded seed file pactravel_final.dim_date ............................ [[32mINSERT 29220[0m in 133.72s]
[0m20:00:12  
[0m20:00:12  Running dbt Constraints
[0m20:00:12  Finished dbt Constraints
[0m20:00:12  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m20:00:12  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.06s]
[0m20:00:12  
[0m20:00:12  Finished running 1 project hook, 1 seed in 0 hours 2 minutes and 13.99 seconds (133.99s).
[0m20:00:13  
[0m20:00:13  [32mCompleted successfully[0m
[0m20:00:13  
[0m20:00:13  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:00:15  Running with dbt=1.9.0-b4
[0m20:00:15  Registered adapter: postgres=1.8.2
[0m20:00:16  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m20:00:16  
[0m20:00:16  Concurrency: 1 threads (target='dev')
[0m20:00:16  
[0m20:00:16  1 of 15 START sql view model pactravel_final.stg_pactravel__aircrafts .......... [RUN]
[0m20:00:16  1 of 15 OK created sql view model pactravel_final.stg_pactravel__aircrafts ..... [[32mCREATE VIEW[0m in 0.12s]
[0m20:00:16  2 of 15 START sql view model pactravel_final.stg_pactravel__airlines ........... [RUN]
[0m20:00:16  2 of 15 OK created sql view model pactravel_final.stg_pactravel__airlines ...... [[32mCREATE VIEW[0m in 0.06s]
[0m20:00:16  3 of 15 START sql view model pactravel_final.stg_pactravel__airports ........... [RUN]
[0m20:00:16  3 of 15 OK created sql view model pactravel_final.stg_pactravel__airports ...... [[32mCREATE VIEW[0m in 0.06s]
[0m20:00:16  4 of 15 START sql view model pactravel_final.stg_pactravel__customers .......... [RUN]
[0m20:00:16  4 of 15 OK created sql view model pactravel_final.stg_pactravel__customers ..... [[32mCREATE VIEW[0m in 0.06s]
[0m20:00:16  5 of 15 START sql view model pactravel_final.stg_pactravel__flight_bookings .... [RUN]
[0m20:00:16  5 of 15 OK created sql view model pactravel_final.stg_pactravel__flight_bookings  [[32mCREATE VIEW[0m in 0.06s]
[0m20:00:16  6 of 15 START sql view model pactravel_final.stg_pactravel__hotel .............. [RUN]
[0m20:00:16  6 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel ......... [[32mCREATE VIEW[0m in 0.06s]
[0m20:00:16  7 of 15 START sql view model pactravel_final.stg_pactravel__hotel_bookings ..... [RUN]
[0m20:00:16  7 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel_bookings  [[32mCREATE VIEW[0m in 0.06s]
[0m20:00:16  8 of 15 START sql table model pactravel_final.dim_aircrafts .................... [RUN]
[0m20:00:17  8 of 15 OK created sql table model pactravel_final.dim_aircrafts ............... [[32mSELECT 246[0m in 0.11s]
[0m20:00:17  9 of 15 START sql table model pactravel_final.dim_airlines ..................... [RUN]
[0m20:00:17  9 of 15 OK created sql table model pactravel_final.dim_airlines ................ [[32mSELECT 1251[0m in 0.08s]
[0m20:00:17  10 of 15 START sql table model pactravel_final.dim_airports .................... [RUN]
[0m20:00:17  10 of 15 OK created sql table model pactravel_final.dim_airports ............... [[32mSELECT 105[0m in 0.08s]
[0m20:00:17  11 of 15 START sql table model pactravel_final.dim_customers ................... [RUN]
[0m20:00:17  11 of 15 OK created sql table model pactravel_final.dim_customers .............. [[32mSELECT 1000[0m in 0.17s]
[0m20:00:17  12 of 15 START sql table model pactravel_final.dim_hotel ....................... [RUN]
[0m20:00:17  12 of 15 OK created sql table model pactravel_final.dim_hotel .................. [[32mSELECT 1470[0m in 0.09s]
[0m20:00:17  13 of 15 START sql table model pactravel_final.fct_daily_revenue ............... [RUN]
[0m20:00:17  13 of 15 OK created sql table model pactravel_final.fct_daily_revenue .......... [[32mSELECT 2400[0m in 0.08s]
[0m20:00:17  14 of 15 START sql table model pactravel_final.fct_flight_bookings ............. [RUN]
[0m20:00:18  14 of 15 OK created sql table model pactravel_final.fct_flight_bookings ........ [[32mSELECT 8190[0m in 0.95s]
[0m20:00:18  15 of 15 START sql table model pactravel_final.fct_hotel_bookings .............. [RUN]
[0m20:00:19  15 of 15 OK created sql table model pactravel_final.fct_hotel_bookings ......... [[32mSELECT 217[0m in 0.65s]
[0m20:00:19  
[0m20:00:19  Running dbt Constraints
[0m20:00:19  Finished dbt Constraints
[0m20:00:19  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m20:00:19  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m20:00:19  
[0m20:00:19  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m20:00:19  
[0m20:00:19  [32mCompleted successfully[0m
[0m20:00:19  
[0m20:00:19  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m20:00:21  Running with dbt=1.9.0-b4
[0m20:00:22  Registered adapter: postgres=1.8.2
[0m20:00:22  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m20:00:22  
[0m20:00:22  Concurrency: 1 threads (target='dev')
[0m20:00:22  
[0m20:00:22  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m20:00:23  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mINSERT 0 1251[0m in 0.21s]
[0m20:00:23  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m20:00:23  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mINSERT 0 1000[0m in 0.10s]
[0m20:00:23  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m20:00:23  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mINSERT 0 1470[0m in 0.12s]
[0m20:00:23  
[0m20:00:23  Running dbt Constraints
[0m20:00:23  Finished dbt Constraints
[0m20:00:23  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m20:00:23  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.05s]
[0m20:00:23  
[0m20:00:23  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m20:00:23  
[0m20:00:23  [32mCompleted successfully[0m
[0m20:00:23  
[0m20:00:23  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:00:25  Running with dbt=1.9.0-b4
[0m20:00:26  Registered adapter: postgres=1.8.2
[0m20:00:26  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m20:00:26  
[0m20:00:26  Concurrency: 1 threads (target='dev')
[0m20:00:26  
[0m20:00:26  1 of 47 START test dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [RUN]
[0m20:00:26  1 of 47 PASS dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.07s]
[0m20:00:26  2 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m20:00:26  2 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.03s]
[0m20:00:26  3 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m20:00:26  3 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.03s]
[0m20:00:26  4 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m20:00:26  4 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m20:00:26  5 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m20:00:26  5 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.03s]
[0m20:00:26  6 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m20:00:26  6 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m20:00:26  7 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m20:00:26  7 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m20:00:26  8 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m20:00:27  8 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m20:00:27  9 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m20:00:27  9 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m20:00:27  10 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m20:00:27  10 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.03s]
[0m20:00:27  11 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m20:00:27  11 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.03s]
[0m20:00:27  12 of 47 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m20:00:27  12 of 47 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.03s]
[0m20:00:27  13 of 47 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m20:00:27  13 of 47 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.03s]
[0m20:00:27  14 of 47 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m20:00:27  14 of 47 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.03s]
[0m20:00:27  15 of 47 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m20:00:27  15 of 47 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.03s]
[0m20:00:27  16 of 47 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m20:00:27  16 of 47 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.04s]
[0m20:00:27  17 of 47 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m20:00:27  17 of 47 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.03s]
[0m20:00:27  18 of 47 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m20:00:27  18 of 47 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.04s]
[0m20:00:27  19 of 47 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m20:00:27  19 of 47 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.04s]
[0m20:00:27  20 of 47 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m20:00:27  20 of 47 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m20:00:27  21 of 47 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m20:00:27  21 of 47 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.03s]
[0m20:00:27  22 of 47 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m20:00:27  22 of 47 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m20:00:27  23 of 47 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m20:00:27  23 of 47 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.03s]
[0m20:00:27  24 of 47 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m20:00:27  24 of 47 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m20:00:27  25 of 47 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m20:00:27  25 of 47 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.03s]
[0m20:00:27  26 of 47 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m20:00:27  26 of 47 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.02s]
[0m20:00:27  27 of 47 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m20:00:27  27 of 47 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.03s]
[0m20:00:27  28 of 47 START test not_null_dim_date_date_id .................................. [RUN]
[0m20:00:27  28 of 47 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.03s]
[0m20:00:27  29 of 47 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m20:00:27  29 of 47 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m20:00:27  30 of 47 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m20:00:27  30 of 47 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.03s]
[0m20:00:27  31 of 47 START test not_null_fct_daily_revenue_booking_date .................... [RUN]
[0m20:00:27  31 of 47 PASS not_null_fct_daily_revenue_booking_date .......................... [[32mPASS[0m in 0.03s]
[0m20:00:27  32 of 47 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m20:00:27  32 of 47 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.03s]
[0m20:00:27  33 of 47 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m20:00:27  33 of 47 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.03s]
[0m20:00:27  34 of 47 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m20:00:27  34 of 47 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.08s]
[0m20:00:27  35 of 47 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m20:00:27  35 of 47 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m20:00:27  36 of 47 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m20:00:27  36 of 47 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.03s]
[0m20:00:27  37 of 47 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m20:00:27  37 of 47 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.03s]
[0m20:00:27  38 of 47 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m20:00:28  38 of 47 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.03s]
[0m20:00:28  39 of 47 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m20:00:28  39 of 47 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.03s]
[0m20:00:28  40 of 47 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m20:00:28  40 of 47 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.03s]
[0m20:00:28  41 of 47 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m20:00:28  41 of 47 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.03s]
[0m20:00:28  42 of 47 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m20:00:28  42 of 47 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.02s]
[0m20:00:28  43 of 47 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m20:00:28  43 of 47 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.03s]
[0m20:00:28  44 of 47 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m20:00:28  44 of 47 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.02s]
[0m20:00:28  45 of 47 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m20:00:28  45 of 47 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.03s]
[0m20:00:28  46 of 47 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m20:00:28  46 of 47 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.03s]
[0m20:00:28  47 of 47 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m20:00:28  47 of 47 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.02s]
[0m20:00:28  
[0m20:00:28  Running dbt Constraints
[0m20:00:28  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m20:00:28  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m20:00:28  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m20:00:28  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m20:00:28  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m20:00:28  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m20:00:28  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m20:00:28  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m20:00:28  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m20:00:28  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m20:00:28  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m20:00:28  Creating not null constraint for: booking_date in "pactravel-dwh"."pactravel_final"."fct_daily_revenue"
[0m20:00:28  Creating not null constraint for: aircraft_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: airline_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: arrival_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: departure_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: departure_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:28  Creating not null constraint for: check_in_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: check_out_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: hotel_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:28  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m20:00:28  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m20:00:28  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m20:00:28  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m20:00:28  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m20:00:28  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m20:00:28  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m20:00:28  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m20:00:28  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m20:00:28  Creating primary key: DIM_DATE_DATE_ID_PK
[0m20:00:28  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m20:00:29  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m20:00:29  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m20:00:29  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m20:00:29  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m20:00:29  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m20:00:29  Skipping FCT_DAILY_REVENUE_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m20:00:29  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_aircrafts" ['nk_aircraft_id']
[0m20:00:29  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airlines" ['nk_airline_id']
[0m20:00:29  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m20:00:29  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m20:00:29  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m20:00:29  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m20:00:29  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m20:00:29  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m20:00:29  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m20:00:29  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_hotel" ['nk_hotel_id']
[0m20:00:29  Finished dbt Constraints
[0m20:00:29  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m20:00:29  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 1.00s]
[0m20:00:29  
[0m20:00:29  Finished running 1 project hook, 47 data tests in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m20:00:29  
[0m20:00:29  [32mCompleted successfully[0m
[0m20:00:29  
[0m20:00:29  Done. PASS=48 WARN=0 ERROR=0 SKIP=0 TOTAL=48
2024-11-09 03:00:30,785 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2024-11-09 03:00:30,785 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2024-11-09 03:00:30,785 - INFO - [pid 95190] Worker Worker(salt=8171597509, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=95190) done      Transform()
2024-11-09 03:00:30,786 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 03:00:30,789 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2024-11-09 03:00:30,789 - DEBUG - Asking scheduler for work...
2024-11-09 03:00:30,791 - DEBUG - Done
2024-11-09 03:00:30,791 - DEBUG - There are no more tasks to run at this time
2024-11-09 03:00:30,792 - INFO - Worker Worker(salt=8171597509, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=95190) was stopped. Shutting down Keep-Alive thread
2024-11-09 03:00:30,793 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2024-11-09 15:31:24,132 - INFO - ==================================STARTING EXTRACT DATA=======================================
2024-11-09 15:31:24,293 - INFO - EXTRACT 'public.aircrafts' - SUCCESS.
2024-11-09 15:31:24,324 - INFO - EXTRACT 'public.airlines' - SUCCESS.
2024-11-09 15:31:24,340 - INFO - EXTRACT 'public.airports' - SUCCESS.
2024-11-09 15:31:24,373 - INFO - EXTRACT 'public.customers' - SUCCESS.
2024-11-09 15:31:24,432 - INFO - EXTRACT 'public.hotel' - SUCCESS.
2024-11-09 15:31:24,600 - INFO - EXTRACT 'public.flight_bookings' - SUCCESS.
2024-11-09 15:31:24,612 - INFO - EXTRACT 'public.hotel_bookings' - SUCCESS.
2024-11-09 15:31:24,612 - INFO - EXTRACT ALL TABLE FROM SOURCE DATABASE - SUCCESS!
2024-11-09 15:31:24,616 - INFO - ==================================ENDING EXTRACT DATA=======================================
2024-11-09 15:31:24,616 - INFO - [pid 9049] Worker Worker(salt=557426697, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=9049) done      Extract()
2024-11-09 15:31:24,617 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 15:31:24,622 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2024-11-09 15:31:24,622 - DEBUG - Asking scheduler for work...
2024-11-09 15:31:24,627 - DEBUG - Pending tasks: 2
2024-11-09 15:31:24,627 - INFO - [pid 9049] Worker Worker(salt=557426697, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=9049) running   Load()
2024-11-09 15:31:24,632 - INFO - Read Load Query - SUCCESS!
2024-11-09 15:31:24,673 - INFO - Read Extracted Data - SUCCESS!
2024-11-09 15:31:24,674 - INFO - Connect to DWH - SUCCESS!
2024-11-09 15:31:24,923 - INFO - Truncate public Schema in DWH - SUCCESS!
2024-11-09 15:31:24,924 - INFO - ==================================STARTING LOAD DATA=======================================
2024-11-09 15:31:24,976 - INFO - Load aircrafts table - SUCCESS!
2024-11-09 15:31:25,095 - INFO - Load airlines table - SUCCESS!
2024-11-09 15:31:25,128 - INFO - Load airports table - SUCCESS!
2024-11-09 15:31:25,237 - INFO - Load customers table - SUCCESS!
2024-11-09 15:31:25,326 - INFO - Load hotel table - SUCCESS!
2024-11-09 15:31:27,896 - INFO - Load flight_bookings table - SUCCESS!
2024-11-09 15:31:27,942 - INFO - Load hotel_bookings table - SUCCESS!
2024-11-09 15:31:27,943 - INFO - LOAD All Tables To Pactravel DWH - SUCCESS!
2024-11-09 15:31:28,875 - INFO - LOAD All Tables To Pactravel Staging - SUCCESS
2024-11-09 15:31:28,878 - INFO - ==================================ENDING LOAD DATA=======================================
2024-11-09 15:31:28,879 - INFO - [pid 9049] Worker Worker(salt=557426697, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=9049) done      Load()
2024-11-09 15:31:28,880 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 15:31:28,883 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2024-11-09 15:31:28,884 - DEBUG - Asking scheduler for work...
2024-11-09 15:31:28,887 - DEBUG - Pending tasks: 1
2024-11-09 15:31:28,887 - INFO - [pid 9049] Worker Worker(salt=557426697, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=9049) running   Transform()
2024-11-09 15:31:28,888 - INFO - ==================================STARTING TRANSFROM DATA=======================================
[0m08:31:34  Running with dbt=1.9.0-b4
[0m08:31:37  Installing dbt-labs/dbt_utils
[0m08:31:38  Installed from version 1.1.1
[0m08:31:38  Updated version available: 1.3.0
[0m08:31:38  Installing calogica/dbt_date
[0m08:31:38  Installed from version 0.10.0
[0m08:31:38  Updated version available: 0.10.1
[0m08:31:38  Installing Snowflake-Labs/dbt_constraints
[0m08:31:40  Installed from version 0.6.3
[0m08:31:40  Updated version available: 1.0.4
[0m08:31:40  
[0m08:31:40  Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'Snowflake-Labs/dbt_constraints']                 
Update your versions in packages.yml, then run dbt deps
[0m08:31:45  Running with dbt=1.9.0-b4
[0m08:31:45  Registered adapter: postgres=1.8.2
[0m08:31:47  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m08:31:47  
[0m08:31:47  Concurrency: 1 threads (target='dev')
[0m08:31:47  
[0m08:31:48  1 of 1 START seed file pactravel_final.dim_date ................................ [RUN]
[0m08:37:01  1 of 1 OK loaded seed file pactravel_final.dim_date ............................ [[32mINSERT 29220[0m in 313.17s]
[0m08:37:01  
[0m08:37:01  Running dbt Constraints
[0m08:37:01  Finished dbt Constraints
[0m08:37:02  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m08:37:02  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.18s]
[0m08:37:02  
[0m08:37:02  Finished running 1 project hook, 1 seed in 0 hours 5 minutes and 14.35 seconds (314.35s).
[0m08:37:02  
[0m08:37:02  [32mCompleted successfully[0m
[0m08:37:02  
[0m08:37:02  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:37:06  Running with dbt=1.9.0-b4
[0m08:37:07  Registered adapter: postgres=1.8.2
[0m08:37:08  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m08:37:08  
[0m08:37:08  Concurrency: 1 threads (target='dev')
[0m08:37:08  
[0m08:37:08  1 of 15 START sql view model pactravel_final.stg_pactravel__aircrafts .......... [RUN]
[0m08:37:09  1 of 15 OK created sql view model pactravel_final.stg_pactravel__aircrafts ..... [[32mCREATE VIEW[0m in 0.31s]
[0m08:37:09  2 of 15 START sql view model pactravel_final.stg_pactravel__airlines ........... [RUN]
[0m08:37:09  2 of 15 OK created sql view model pactravel_final.stg_pactravel__airlines ...... [[32mCREATE VIEW[0m in 0.13s]
[0m08:37:09  3 of 15 START sql view model pactravel_final.stg_pactravel__airports ........... [RUN]
[0m08:37:09  3 of 15 OK created sql view model pactravel_final.stg_pactravel__airports ...... [[32mCREATE VIEW[0m in 0.19s]
[0m08:37:09  4 of 15 START sql view model pactravel_final.stg_pactravel__customers .......... [RUN]
[0m08:37:09  4 of 15 OK created sql view model pactravel_final.stg_pactravel__customers ..... [[32mCREATE VIEW[0m in 0.21s]
[0m08:37:09  5 of 15 START sql view model pactravel_final.stg_pactravel__flight_bookings .... [RUN]
[0m08:37:09  5 of 15 OK created sql view model pactravel_final.stg_pactravel__flight_bookings  [[32mCREATE VIEW[0m in 0.18s]
[0m08:37:09  6 of 15 START sql view model pactravel_final.stg_pactravel__hotel .............. [RUN]
[0m08:37:10  6 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel ......... [[32mCREATE VIEW[0m in 0.18s]
[0m08:37:10  7 of 15 START sql view model pactravel_final.stg_pactravel__hotel_bookings ..... [RUN]
[0m08:37:10  7 of 15 OK created sql view model pactravel_final.stg_pactravel__hotel_bookings  [[32mCREATE VIEW[0m in 0.17s]
[0m08:37:10  8 of 15 START sql table model pactravel_final.dim_aircrafts .................... [RUN]
[0m08:37:10  8 of 15 OK created sql table model pactravel_final.dim_aircrafts ............... [[32mSELECT 246[0m in 0.22s]
[0m08:37:10  9 of 15 START sql table model pactravel_final.dim_airlines ..................... [RUN]
[0m08:37:10  9 of 15 OK created sql table model pactravel_final.dim_airlines ................ [[32mSELECT 1251[0m in 0.15s]
[0m08:37:10  10 of 15 START sql table model pactravel_final.dim_airports .................... [RUN]
[0m08:37:10  10 of 15 OK created sql table model pactravel_final.dim_airports ............... [[32mSELECT 105[0m in 0.18s]
[0m08:37:10  11 of 15 START sql table model pactravel_final.dim_customers ................... [RUN]
[0m08:37:11  11 of 15 OK created sql table model pactravel_final.dim_customers .............. [[32mSELECT 1000[0m in 0.24s]
[0m08:37:11  12 of 15 START sql table model pactravel_final.dim_hotel ....................... [RUN]
[0m08:37:11  12 of 15 OK created sql table model pactravel_final.dim_hotel .................. [[32mSELECT 1470[0m in 0.12s]
[0m08:37:11  13 of 15 START sql table model pactravel_final.fct_daily_revenue ............... [RUN]
[0m08:37:11  13 of 15 OK created sql table model pactravel_final.fct_daily_revenue .......... [[32mSELECT 2396[0m in 0.25s]
[0m08:37:11  14 of 15 START sql table model pactravel_final.fct_flight_bookings ............. [RUN]
[0m08:37:14  14 of 15 OK created sql table model pactravel_final.fct_flight_bookings ........ [[32mSELECT 8190[0m in 3.36s]
[0m08:37:14  15 of 15 START sql table model pactravel_final.fct_hotel_bookings .............. [RUN]
[0m08:37:16  15 of 15 OK created sql table model pactravel_final.fct_hotel_bookings ......... [[32mSELECT 217[0m in 1.62s]
[0m08:37:16  
[0m08:37:16  Running dbt Constraints
[0m08:37:16  Finished dbt Constraints
[0m08:37:16  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m08:37:16  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.21s]
[0m08:37:16  
[0m08:37:16  Finished running 1 project hook, 8 table models, 7 view models in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m08:37:16  
[0m08:37:16  [32mCompleted successfully[0m
[0m08:37:16  
[0m08:37:16  Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m08:37:21  Running with dbt=1.9.0-b4
[0m08:37:21  Registered adapter: postgres=1.8.2
[0m08:37:23  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m08:37:23  
[0m08:37:23  Concurrency: 1 threads (target='dev')
[0m08:37:23  
[0m08:37:23  1 of 3 START snapshot pactravel_snapshots.airlines_snapshot .................... [RUN]
[0m08:37:24  1 of 3 OK snapshotted pactravel_snapshots.airlines_snapshot .................... [[32mSELECT 1251[0m in 0.50s]
[0m08:37:24  2 of 3 START snapshot pactravel_snapshots.customers_snapshot ................... [RUN]
[0m08:37:24  2 of 3 OK snapshotted pactravel_snapshots.customers_snapshot ................... [[32mSELECT 1000[0m in 0.12s]
[0m08:37:24  3 of 3 START snapshot pactravel_snapshots.hotel_snapshot ....................... [RUN]
[0m08:37:24  3 of 3 OK snapshotted pactravel_snapshots.hotel_snapshot ....................... [[32mSELECT 1470[0m in 0.12s]
[0m08:37:24  
[0m08:37:24  Running dbt Constraints
[0m08:37:24  Finished dbt Constraints
[0m08:37:24  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m08:37:24  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 0.15s]
[0m08:37:24  
[0m08:37:24  Finished running 1 project hook, 3 snapshots in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m08:37:24  
[0m08:37:24  [32mCompleted successfully[0m
[0m08:37:24  
[0m08:37:24  Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:37:29  Running with dbt=1.9.0-b4
[0m08:37:29  Registered adapter: postgres=1.8.2
[0m08:37:31  Found 15 models, 3 snapshots, 1 seed, 1 operation, 47 data tests, 7 sources, 751 macros
[0m08:37:31  
[0m08:37:31  Concurrency: 1 threads (target='dev')
[0m08:37:31  
[0m08:37:31  1 of 47 START test dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [RUN]
[0m08:37:31  1 of 47 PASS dbt_constraints_foreign_key_fct_daily_revenue_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.28s]
[0m08:37:31  2 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [RUN]
[0m08:37:32  2 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_aircraft_id__nk_aircraft_id__ref_dim_aircrafts_  [[32mPASS[0m in 0.13s]
[0m08:37:32  3 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [RUN]
[0m08:37:32  3 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_airline_id__nk_airline_id__ref_dim_airlines_  [[32mPASS[0m in 0.12s]
[0m08:37:32  4 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [RUN]
[0m08:37:32  4 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_arrival_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.12s]
[0m08:37:32  5 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [RUN]
[0m08:37:32  5 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_airport__airport_name__ref_dim_airports_  [[32mPASS[0m in 0.12s]
[0m08:37:32  6 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [RUN]
[0m08:37:32  6 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_departure_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.14s]
[0m08:37:32  7 of 47 START test dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [RUN]
[0m08:37:32  7 of 47 PASS dbt_constraints_foreign_key_fct_flight_bookings_flight_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.14s]
[0m08:37:32  8 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [RUN]
[0m08:37:32  8 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_in_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.12s]
[0m08:37:32  9 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [RUN]
[0m08:37:33  9 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_check_out_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.12s]
[0m08:37:33  10 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [RUN]
[0m08:37:33  10 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_booking_date__date_actual__ref_dim_date_  [[32mPASS[0m in 0.12s]
[0m08:37:33  11 of 47 START test dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [RUN]
[0m08:37:33  11 of 47 PASS dbt_constraints_foreign_key_fct_hotel_bookings_hotel_id__nk_hotel_id__ref_dim_hotel_  [[32mPASS[0m in 0.12s]
[0m08:37:33  12 of 47 START test dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ... [RUN]
[0m08:37:33  12 of 47 PASS dbt_constraints_primary_key_dim_aircrafts_sk_aircraft_id ......... [[32mPASS[0m in 0.12s]
[0m08:37:33  13 of 47 START test dbt_constraints_primary_key_dim_airlines_sk_airline_id ..... [RUN]
[0m08:37:33  13 of 47 PASS dbt_constraints_primary_key_dim_airlines_sk_airline_id ........... [[32mPASS[0m in 0.12s]
[0m08:37:33  14 of 47 START test dbt_constraints_primary_key_dim_airports_sk_airport_id ..... [RUN]
[0m08:37:33  14 of 47 PASS dbt_constraints_primary_key_dim_airports_sk_airport_id ........... [[32mPASS[0m in 0.13s]
[0m08:37:33  15 of 47 START test dbt_constraints_primary_key_dim_customers_sk_customer_id ... [RUN]
[0m08:37:33  15 of 47 PASS dbt_constraints_primary_key_dim_customers_sk_customer_id ......... [[32mPASS[0m in 0.11s]
[0m08:37:33  16 of 47 START test dbt_constraints_primary_key_dim_date_date_id ............... [RUN]
[0m08:37:33  16 of 47 PASS dbt_constraints_primary_key_dim_date_date_id ..................... [[32mPASS[0m in 0.16s]
[0m08:37:34  17 of 47 START test dbt_constraints_primary_key_dim_hotel_sk_hotel_id .......... [RUN]
[0m08:37:34  17 of 47 PASS dbt_constraints_primary_key_dim_hotel_sk_hotel_id ................ [[32mPASS[0m in 0.14s]
[0m08:37:34  18 of 47 START test dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [RUN]
[0m08:37:34  18 of 47 PASS dbt_constraints_primary_key_fct_flight_bookings_sk_flight_booking_id  [[32mPASS[0m in 0.12s]
[0m08:37:34  19 of 47 START test dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [RUN]
[0m08:37:34  19 of 47 PASS dbt_constraints_primary_key_fct_hotel_bookings_sk_hotel_booking_id  [[32mPASS[0m in 0.10s]
[0m08:37:34  20 of 47 START test not_null_dim_aircrafts_nk_aircraft_id ...................... [RUN]
[0m08:37:34  20 of 47 PASS not_null_dim_aircrafts_nk_aircraft_id ............................ [[32mPASS[0m in 0.11s]
[0m08:37:34  21 of 47 START test not_null_dim_aircrafts_sk_aircraft_id ...................... [RUN]
[0m08:37:34  21 of 47 PASS not_null_dim_aircrafts_sk_aircraft_id ............................ [[32mPASS[0m in 0.10s]
[0m08:37:34  22 of 47 START test not_null_dim_airlines_nk_airline_id ........................ [RUN]
[0m08:37:34  22 of 47 PASS not_null_dim_airlines_nk_airline_id .............................. [[32mPASS[0m in 0.10s]
[0m08:37:34  23 of 47 START test not_null_dim_airlines_sk_airline_id ........................ [RUN]
[0m08:37:34  23 of 47 PASS not_null_dim_airlines_sk_airline_id .............................. [[32mPASS[0m in 0.09s]
[0m08:37:34  24 of 47 START test not_null_dim_airports_nk_airport_id ........................ [RUN]
[0m08:37:34  24 of 47 PASS not_null_dim_airports_nk_airport_id .............................. [[32mPASS[0m in 0.10s]
[0m08:37:34  25 of 47 START test not_null_dim_airports_sk_airport_id ........................ [RUN]
[0m08:37:35  25 of 47 PASS not_null_dim_airports_sk_airport_id .............................. [[32mPASS[0m in 0.09s]
[0m08:37:35  26 of 47 START test not_null_dim_customers_nk_customer_id ...................... [RUN]
[0m08:37:35  26 of 47 PASS not_null_dim_customers_nk_customer_id ............................ [[32mPASS[0m in 0.12s]
[0m08:37:35  27 of 47 START test not_null_dim_customers_sk_customer_id ...................... [RUN]
[0m08:37:35  27 of 47 PASS not_null_dim_customers_sk_customer_id ............................ [[32mPASS[0m in 0.11s]
[0m08:37:35  28 of 47 START test not_null_dim_date_date_id .................................. [RUN]
[0m08:37:35  28 of 47 PASS not_null_dim_date_date_id ........................................ [[32mPASS[0m in 0.11s]
[0m08:37:35  29 of 47 START test not_null_dim_hotel_nk_hotel_id ............................. [RUN]
[0m08:37:35  29 of 47 PASS not_null_dim_hotel_nk_hotel_id ................................... [[32mPASS[0m in 0.10s]
[0m08:37:35  30 of 47 START test not_null_dim_hotel_sk_hotel_id ............................. [RUN]
[0m08:37:35  30 of 47 PASS not_null_dim_hotel_sk_hotel_id ................................... [[32mPASS[0m in 0.10s]
[0m08:37:35  31 of 47 START test not_null_fct_daily_revenue_booking_date .................... [RUN]
[0m08:37:35  31 of 47 PASS not_null_fct_daily_revenue_booking_date .......................... [[32mPASS[0m in 0.11s]
[0m08:37:35  32 of 47 START test not_null_fct_flight_bookings_aircraft_id ................... [RUN]
[0m08:37:35  32 of 47 PASS not_null_fct_flight_bookings_aircraft_id ......................... [[32mPASS[0m in 0.11s]
[0m08:37:35  33 of 47 START test not_null_fct_flight_bookings_airline_id .................... [RUN]
[0m08:37:35  33 of 47 PASS not_null_fct_flight_bookings_airline_id .......................... [[32mPASS[0m in 0.10s]
[0m08:37:36  34 of 47 START test not_null_fct_flight_bookings_arrival_airport ............... [RUN]
[0m08:37:36  34 of 47 PASS not_null_fct_flight_bookings_arrival_airport ..................... [[32mPASS[0m in 0.16s]
[0m08:37:36  35 of 47 START test not_null_fct_flight_bookings_dd_flight_booking_id .......... [RUN]
[0m08:37:36  35 of 47 PASS not_null_fct_flight_bookings_dd_flight_booking_id ................ [[32mPASS[0m in 0.07s]
[0m08:37:36  36 of 47 START test not_null_fct_flight_bookings_dd_trip_id .................... [RUN]
[0m08:37:36  36 of 47 PASS not_null_fct_flight_bookings_dd_trip_id .......................... [[32mPASS[0m in 0.07s]
[0m08:37:36  37 of 47 START test not_null_fct_flight_bookings_departure_airport ............. [RUN]
[0m08:37:36  37 of 47 PASS not_null_fct_flight_bookings_departure_airport ................... [[32mPASS[0m in 0.09s]
[0m08:37:36  38 of 47 START test not_null_fct_flight_bookings_departure_date ................ [RUN]
[0m08:37:36  38 of 47 PASS not_null_fct_flight_bookings_departure_date ...................... [[32mPASS[0m in 0.09s]
[0m08:37:36  39 of 47 START test not_null_fct_flight_bookings_flight_booking_date ........... [RUN]
[0m08:37:36  39 of 47 PASS not_null_fct_flight_bookings_flight_booking_date ................. [[32mPASS[0m in 0.09s]
[0m08:37:36  40 of 47 START test not_null_fct_flight_bookings_sk_flight_booking_id .......... [RUN]
[0m08:37:36  40 of 47 PASS not_null_fct_flight_bookings_sk_flight_booking_id ................ [[32mPASS[0m in 0.10s]
[0m08:37:36  41 of 47 START test not_null_fct_hotel_bookings_check_in_date .................. [RUN]
[0m08:37:36  41 of 47 PASS not_null_fct_hotel_bookings_check_in_date ........................ [[32mPASS[0m in 0.10s]
[0m08:37:36  42 of 47 START test not_null_fct_hotel_bookings_check_out_date ................. [RUN]
[0m08:37:36  42 of 47 PASS not_null_fct_hotel_bookings_check_out_date ....................... [[32mPASS[0m in 0.10s]
[0m08:37:36  43 of 47 START test not_null_fct_hotel_bookings_dd_hotel_booking_id ............ [RUN]
[0m08:37:37  43 of 47 PASS not_null_fct_hotel_bookings_dd_hotel_booking_id .................. [[32mPASS[0m in 0.09s]
[0m08:37:37  44 of 47 START test not_null_fct_hotel_bookings_dd_trip_id ..................... [RUN]
[0m08:37:37  44 of 47 PASS not_null_fct_hotel_bookings_dd_trip_id ........................... [[32mPASS[0m in 0.09s]
[0m08:37:37  45 of 47 START test not_null_fct_hotel_bookings_hotel_booking_date ............. [RUN]
[0m08:37:37  45 of 47 PASS not_null_fct_hotel_bookings_hotel_booking_date ................... [[32mPASS[0m in 0.10s]
[0m08:37:37  46 of 47 START test not_null_fct_hotel_bookings_hotel_id ....................... [RUN]
[0m08:37:37  46 of 47 PASS not_null_fct_hotel_bookings_hotel_id ............................. [[32mPASS[0m in 0.10s]
[0m08:37:37  47 of 47 START test not_null_fct_hotel_bookings_sk_hotel_booking_id ............ [RUN]
[0m08:37:37  47 of 47 PASS not_null_fct_hotel_bookings_sk_hotel_booking_id .................. [[32mPASS[0m in 0.10s]
[0m08:37:37  
[0m08:37:37  Running dbt Constraints
[0m08:37:37  Creating not null constraint for: nk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m08:37:37  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m08:37:37  Creating not null constraint for: nk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m08:37:37  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m08:37:37  Creating not null constraint for: nk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m08:37:37  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m08:37:38  Creating not null constraint for: nk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m08:37:38  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m08:37:38  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m08:37:38  Creating not null constraint for: nk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m08:37:38  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m08:37:38  Creating not null constraint for: booking_date in "pactravel-dwh"."pactravel_final"."fct_daily_revenue"
[0m08:37:38  Creating not null constraint for: aircraft_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: airline_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: arrival_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: dd_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: departure_airport in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: departure_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: flight_booking_date in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:38  Creating not null constraint for: check_in_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: check_out_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: dd_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: dd_trip_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: hotel_booking_date in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: hotel_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:38  Creating not null constraint for: sk_aircraft_id in "pactravel-dwh"."pactravel_final"."dim_aircrafts"
[0m08:37:39  Creating primary key: DIM_AIRCRAFTS_SK_AIRCRAFT_ID_PK
[0m08:37:39  Creating not null constraint for: sk_airline_id in "pactravel-dwh"."pactravel_final"."dim_airlines"
[0m08:37:39  Creating primary key: DIM_AIRLINES_SK_AIRLINE_ID_PK
[0m08:37:39  Creating not null constraint for: sk_airport_id in "pactravel-dwh"."pactravel_final"."dim_airports"
[0m08:37:39  Creating primary key: DIM_AIRPORTS_SK_AIRPORT_ID_PK
[0m08:37:39  Creating not null constraint for: sk_customer_id in "pactravel-dwh"."pactravel_final"."dim_customers"
[0m08:37:39  Creating primary key: DIM_CUSTOMERS_SK_CUSTOMER_ID_PK
[0m08:37:39  Creating not null constraint for: date_id in "pactravel-dwh"."pactravel_final"."dim_date"
[0m08:37:39  Creating primary key: DIM_DATE_DATE_ID_PK
[0m08:37:39  Creating not null constraint for: sk_hotel_id in "pactravel-dwh"."pactravel_final"."dim_hotel"
[0m08:37:39  Creating primary key: DIM_HOTEL_SK_HOTEL_ID_PK
[0m08:37:39  Creating not null constraint for: sk_flight_booking_id in "pactravel-dwh"."pactravel_final"."fct_flight_bookings"
[0m08:37:39  Creating primary key: FCT_FLIGHT_BOOKINGS_SK_FLIGHT_BOOKING_ID_PK
[0m08:37:39  Creating not null constraint for: sk_hotel_booking_id in "pactravel-dwh"."pactravel_final"."fct_hotel_bookings"
[0m08:37:39  Creating primary key: FCT_HOTEL_BOOKINGS_SK_HOTEL_BOOKING_ID_PK
[0m08:37:40  Skipping FCT_DAILY_REVENUE_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m08:37:40  Skipping FCT_FLIGHT_BOOKINGS_AIRCRAFT_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_aircrafts" ['nk_aircraft_id']
[0m08:37:40  Skipping FCT_FLIGHT_BOOKINGS_AIRLINE_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airlines" ['nk_airline_id']
[0m08:37:40  Skipping FCT_FLIGHT_BOOKINGS_ARRIVAL_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m08:37:40  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_AIRPORT_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_airports" ['airport_name']
[0m08:37:40  Skipping FCT_FLIGHT_BOOKINGS_DEPARTURE_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m08:37:40  Skipping FCT_FLIGHT_BOOKINGS_FLIGHT_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m08:37:40  Skipping FCT_HOTEL_BOOKINGS_CHECK_IN_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m08:37:40  Skipping FCT_HOTEL_BOOKINGS_CHECK_OUT_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m08:37:40  Skipping FCT_HOTEL_BOOKINGS_HOTEL_BOOKING_DATE_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_date" ['date_actual']
[0m08:37:40  Skipping FCT_HOTEL_BOOKINGS_HOTEL_ID_FK because a PK/UK was not found on the PK table: "pactravel-dwh"."pactravel_final"."dim_hotel" ['nk_hotel_id']
[0m08:37:40  Finished dbt Constraints
[0m08:37:40  1 of 1 START hook: dbt_constraints.on-run-end.0 ................................ [RUN]
[0m08:37:40  1 of 1 OK hook: dbt_constraints.on-run-end.0 ................................... [[32mOK[0m in 2.76s]
[0m08:37:40  
[0m08:37:40  Finished running 1 project hook, 47 data tests in 0 hours 0 minutes and 8.92 seconds (8.92s).
[0m08:37:40  
[0m08:37:40  [32mCompleted successfully[0m
[0m08:37:40  
[0m08:37:40  Done. PASS=48 WARN=0 ERROR=0 SKIP=0 TOTAL=48
2024-11-09 15:37:42,224 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS!
2024-11-09 15:37:42,224 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2024-11-09 15:37:42,225 - INFO - [pid 9049] Worker Worker(salt=557426697, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=9049) done      Transform()
2024-11-09 15:37:42,228 - DEBUG - 1 running tasks, waiting for next task to finish
2024-11-09 15:37:42,240 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2024-11-09 15:37:42,241 - DEBUG - Asking scheduler for work...
2024-11-09 15:37:42,250 - DEBUG - Done
2024-11-09 15:37:42,251 - DEBUG - There are no more tasks to run at this time
2024-11-09 15:37:42,252 - INFO - Worker Worker(salt=557426697, workers=1, host=LAPTOP-E1BGNT67, username=ricofebrian, pid=9049) was stopped. Shutting down Keep-Alive thread
2024-11-09 15:37:42,257 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 ran successfully:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

